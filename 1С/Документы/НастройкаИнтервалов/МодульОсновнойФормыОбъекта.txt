Перем мСтароеЗначениеИнтервала;

//Вызывается при окончании редактирования границы интервала
//
Процедура ТабличнаяЧастьПриОкончанииРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования)
	
	Выровнять(Элемент.ТекущаяСтрока);
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	Если ТабличнаяЧасть.Количество() = 0 тогда
		СтрокаОстальные = ТабличнаяЧасть.Добавить();
		СТрокаОстальные.НачалоИнтервала = 500000;
		СтрокаОстальные.Подпись = "Все";
	КонецЕсли;
КонецПроцедуры

Процедура Выровнять(ВведеннаяСтрока = НеОпределено)
	ТабличнаяЧасть.Сортировать("НачалоИнтервала");
	КонИнтервала = 0;
	Для каждого Строка из ТабличнаяЧасть Цикл
		Строка.КонецИнтервала = КОнИнтервала;
		Если ТабличнаяЧасть.Количество()=1 Тогда
			Строка.Подпись = "Все";
		ИначеЕсли Строка.НомерСтроки = 1 тогда
			Строка.Подпись = "Не более " + строка(Строка.НачалоИнтервала) + " дней";
		иначеЕсли Строка.НомерСтроки<ТабличнаяЧасть.Количество() Тогда
			Строка.Подпись = "От " + строка(Строка.КонецИнтервала)+" до " + строка(Строка.НачалоИнтервала) + " дней";
		иначе
			Строка.Подпись = "Остальные (не менее "+строка(Строка.КонецИнтервала)+" дней)";
		КонецЕсли;
		КонИнтервала = Строка.НачалоИнтервала + 1;
	КонецЦикла;
КонецПроцедуры

Процедура ТабличнаяЧастьОбработкаЗаписиНовогоОбъекта(Элемент, Объект, СтандартнаяОбработка)
	Выровнять(Объект);
КонецПроцедуры

Процедура ТабличнаяЧастьПередОкончаниемРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования, Отказ)
	Если ОтменаРедактирования Тогда
		Если не НоваяСтрока Тогда
			Элемент.ТекущаяСтрока.НачалоИнтервала = мСтароеЗначениеИнтервала;
		КонецЕсли;
		
		Возврат;
	КонецЕсли;
	
	Если ТабличнаяЧасть.НайтиСтроки(Новый Структура("НачалоИнтервала", Элемент.ТекущаяСтрока.НачалоИнтервала)).Количество()>1 Тогда
		Предупреждение("Такая граница уже есть! Введите другое значение границы.");
		Отказ = Истина;
	КонецЕсли;
	
КонецПроцедуры

Процедура ТабличнаяЧастьПослеУдаления(Элемент)
	Выровнять();
КонецПроцедуры

Процедура ТабличнаяЧастьПередНачаломИзменения(Элемент, Отказ)
	мСтароеЗначениеИнтервала = Элемент.ТекущаяСтрока.НачалоИнтервала;
КонецПроцедуры