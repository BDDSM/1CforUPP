Перем мСтруктураНастройкиЗаполнения;

Процедура КоманднаяПанельПрофильИзмененияЗаполнить(Кнопка)

	ФормаЗаполнения = ПолучитьФорму("ФормаАвтозаполнения", ЭтаФорма,);

	Если мСтруктураНастройкиЗаполнения <> Неопределено Тогда

		ФормаЗаполнения.НачальноеЗначениеВыбора = мСтруктураНастройкиЗаполнения;

	КонецЕсли;
	
	ФормаЗаполнения.РежимВыбора = Истина;
	ФормаЗаполнения.Открыть();
	
КонецПроцедуры // КоманднаяПанельПрофильИзмененияЗаполнить()

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события ПриОткрытии Формы.
//
Процедура ПриОткрытии()
	
	МеханизмНумерацииОбъектов.ДобавитьВМенюДействияКнопкуРедактированияКода(ЭлементыФормы.ДействияФормы.Кнопки.Подменю);
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю,ЭлементыФормы.Код);

КонецПроцедуры //ПриОткрытии

Процедура ПослеЗаписи()
	
	МеханизмНумерацииОбъектов.ОбновитьПодсказкуКодНомерОбъекта(ЭтотОбъект.Метаданные(), ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);

КонецПроцедуры // ПослеЗаписи()

Процедура ДействияФормыРедактироватьКод(Кнопка)
	
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(ЭтотОбъект.Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
	
КонецПроцедуры // ДействияФормыРедактироватьКод()

Процедура ОбработкаВыбора(ЗначениеВыбора, Источник)

	ПрофильИзменения.Очистить();
	мСтруктураНастройкиЗаполнения = ЗначениеВыбора.Настройка;

    Для каждого Строка Из ЗначениеВыбора.Данные Цикл
	
		СтрокаИзменения = ПрофильИзменения.Добавить();
		СтрокаИзменения.НомерПериода = Строка.НомерПериода;
		СтрокаИзменения.Коэффициент = Строка.Коэффициент;
	
	КонецЦикла; 
	
КонецПроцедуры // ОбработкаВыбора()