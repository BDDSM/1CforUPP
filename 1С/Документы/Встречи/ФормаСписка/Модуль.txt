////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ДЕЙСТВИЯ КОМАНДНЫХ ПАНЕЛЕЙ ФОРМЫ

// Процедура вызывается при выборе пункта подменю "Движения документа по регистрам" меню "Перейти".
// командной панели формы. Процедура отрабатывает печать движений документа по регистрам.
//
Процедура ДействияФормыДвиженияДокументаПоРегистрам(Кнопка)
	
	Если ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	РаботаСДиалогами.НапечататьДвиженияДокумента(ЭлементыФормы.ДокументСписок.ТекущиеДанные.Ссылка);
	
КонецПроцедуры // ДействияФормыДвиженияДокументаПоРегистрам()

// Процедура вызывается при выборе пункта подменю "Структура подчиненности" меню "Перейти".
Процедура ДействияФормыСтруктураПодчиненностиДокумента(Кнопка)
	
	Если ЭлементыФормы.ДокументСписок.ТекущиеДанные = Неопределено тогда
		Возврат
	КонецЕсли;
	
	РаботаСДиалогами.ПоказатьСтруктуруПодчиненностиДокумента(ЭлементыФормы.ДокументСписок.ТекущиеДанные.Ссылка);
	
КонецПроцедуры

Процедура ДокументСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	Если НачалоДня(ДанныеСтроки.ДатаНачала) = НачалоДня(ДанныеСтроки.ДатаОкончания) Тогда
		ОформлениеСтроки.Ячейки.ПериодВстречи.Значение = Формат(ДанныеСтроки.ДатаНачала, "ДФ='дд.ММ.гггг ""c"" Ч:мм'") + " до " + Формат(ДанныеСтроки.ДатаОкончания, "ДФ=Ч:мм");
	Иначе
		Если ДанныеСтроки.ДатаНачала < ДанныеСтроки.ДатаОкончания Тогда
			ОформлениеСтроки.Ячейки.ПериодВстречи.Значение = ПредставлениеПериода(НачалоДня(ДанныеСтроки.ДатаНачала), КонецДня(ДанныеСтроки.ДатаОкончания));
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

ДокументСписок.Колонки.Добавить("ДатаНачала");
ДокументСписок.Колонки.Добавить("ДатаОкончания");