////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

Перем мГоловнаяОрганизация;

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ РАСЧЕТА

// Получаем таблицу сотрудников для сбора данных и расчета
//
// Возвращаемое значение:
//   ТаблицаЗначений - перечень сотрудников, или Неопределено, если по всем
//						поля таблицы: Сотрудник и Физлицо
//
Функция ПолучитьОграничениеНаСотрудников(Отказ)

	МассивПодразделений = Новый Массив;
	
	ТекстЗапроса = "";
	
	Если Не ЗначениеЗаполнено(Ответственный) и Не ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		// нет условий по подразделению	
	ИначеЕсли Не ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		//применяем условие на подразделение по ответственному
		Если ПроцедурыУправленияПерсоналом.ЗначениеУчетнойПолитикиПоПерсоналуОрганизации(глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"), Организация, "РасчетЗарплатыОрганизацииПоОтветственным") Тогда
			//расчет зарплаты по ответственным включен, получим список подразделений
			ТекстЗапроса = 
			"ВЫБРАТЬ 
			|	ПодразделенияОрганизаций.Ссылка
			|ИЗ
			|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
			|ГДЕ
			|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ
			|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
			|				Расчетчики.ПодразделениеОрганизации
			|			ИЗ
			|				РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамПериодРегистрации, ) КАК Расчетчики
			|			ГДЕ
			|				Расчетчики.Пользователь = &парамОтветственный)
			|	И ПодразделенияОрганизаций.Владелец = &парамОрганизация";
	
		КонецЕсли;
		
	Иначе // отбор по подразделению заданному в форме документа	
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ПодразделенияОрганизаций.Ссылка
		|ИЗ
		|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
		|ГДЕ
		|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ(&парамПодразделениеОрганизации)
		|	И ПодразделенияОрганизаций.Владелец = &парамОрганизация";
		
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ТекстЗапроса) Тогда
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("парамОрганизация",				Организация);
		Запрос.УстановитьПараметр("парамПодразделениеОрганизации",	ПодразделениеОрганизации);
		Запрос.УстановитьПараметр("парамПериодРегистрации",			ПериодРегистрации);
		Запрос.УстановитьПараметр("парамОтветственный",				Ответственный);
		
		Запрос.Текст = ТекстЗапроса;
		МассивПодразделений = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка");
		
		Если МассивПодразделений.Количество() = 0 Тогда
			//список может быть пустым когда ответственному не назначены подразделения для расчета
			ОбщегоНазначения.ВывестиИнформациюОбОшибке("Для ответственного не задан список подразделений для расчета!", Отказ, "Расчет страховых взносов");
		КонецЕсли;
	
	КонецЕсли;
	
	Если Отказ Или МассивПодразделений.Количество() = 0 Тогда
		//ошибка или нет отбора по подразделениям, возвращаем пустой список
		Возврат Неопределено; 	
	КонецЕсли;	
	
	//необходимо собрать список сотрудников, которые работали по состоянию на конец месяца
	//в подразделении из списка МассивПодразделений
	
	Запрос = Новый Запрос;

	Запрос.УстановитьПараметр("парамМассивПодразделений",	МассивПодразделений);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация",	мГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамОрганизация",			Организация);
	Запрос.УстановитьПараметр("НачалоПериода",				ПериодРегистрации);
	Запрос.УстановитьПараметр("КонецПериода",				КонецМесяца(ПериодРегистрации));
	
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТСписокВсехФизлиц.ФизЛицо,
	|	МИНИМУМ(ВТСписокВсехФизлиц.Договорник) КАК ТолькоДоговорПодряда
	|ПОМЕСТИТЬ ВТСписокВсехФизлиц
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ОсновныеНачисления.ФизЛицо КАК ФизЛицо,
	|		ВЫБОР
	|			КОГДА ОсновныеНачисления.Сотрудник.ВидДоговора В (ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Подряда), ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Авторский))
	|				ТОГДА 1
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК Договорник
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|	ГДЕ
	|		ОсновныеНачисления.ПериодРегистрации = &НачалоПериода
	|		И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ДополнительныеНачисления.ФизЛицо,
	|		ВЫБОР
	|			КОГДА ДополнительныеНачисления.Сотрудник.ВидДоговора В (ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Подряда), ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Авторский))
	|				ТОГДА 1
	|			ИНАЧЕ 0
	|		КОНЕЦ
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|	ГДЕ
	|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &НачалоПериода
	|		И ДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация) КАК ВТСписокВсехФизлиц
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТСписокВсехФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВТСписокВсехФизлиц.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СписокВсехФизлиц.ФизЛицо КАК Физлицо,
	|	МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период
	|ПОМЕСТИТЬ ВТФизлицаПоследниеДвижения
	|ИЗ
	|	ВТСписокВсехФизлиц КАК СписокВсехФизлиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|		ПО (РаботникиОрганизаций.Организация = &парамГоловнаяОрганизация)
	|			И (РаботникиОрганизаций.Период <= &КонецПериода)
	|			И (РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
	|			И (ВЫБОР
	|				КОГДА РаботникиОрганизаций.ПериодЗавершения <= &КонецПериода
	|						И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
	|				ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
	|			КОНЕЦ = &парамОрганизация)
	|			И СписокВсехФизлиц.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
	|ГДЕ
	|	РаботникиОрганизаций.НомерСтроки ЕСТЬ НЕ NULL 
	|	И СписокВсехФизлиц.ТолькоДоговорПодряда = 0
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокВсехФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ФизлицаПоследниеДвижения.Физлицо,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизаций.ПериодЗавершения <= &КонецПериода
	|				И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
	|		ИНАЧЕ РаботникиОрганизаций.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,
	|	РаботникиОрганизаций.ПричинаИзмененияСостояния
	|ПОМЕСТИТЬ ВТСтрокиФизлиц
	|ИЗ
	|	ВТФизлицаПоследниеДвижения КАК ФизлицаПоследниеДвижения
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|		ПО ФизлицаПоследниеДвижения.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
	|			И ФизлицаПоследниеДвижения.Период = РаботникиОрганизаций.Период
	|			И (РаботникиОрганизаций.Организация = &парамГоловнаяОрганизация)
	|			И (РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
	|			И (ВЫБОР
	|				КОГДА РаботникиОрганизаций.ПериодЗавершения <= &КонецПериода
	|						И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
	|				ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
	|			КОНЕЦ = &парамОрганизация)
	|ГДЕ
	|	РаботникиОрганизаций.НомерСтроки ЕСТЬ НЕ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ПодразделениеОрганизации
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ФизлицаПоследниеДвижения.Физлицо,
	|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ФизлицаПоследниеДвижения.ПодразделениеОрганизации) КАК РазныхСтрок
	|ПОМЕСТИТЬ ВТКоличествоСтрок
	|ИЗ
	|	ВТСтрокиФизлиц КАК ФизлицаПоследниеДвижения
	|
	|СГРУППИРОВАТЬ ПО
	|	ФизлицаПоследниеДвижения.Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СтрокиФизлиц.Физлицо КАК Физлицо,
	|	СтрокиФизлиц.ПодразделениеОрганизации
	|ПОМЕСТИТЬ ВТФизлицаВсеРаботники
	|ИЗ
	|	ВТСтрокиФизлиц КАК СтрокиФизлиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТКоличествоСтрок КАК КоличествоСтрок
	|		ПО СтрокиФизлиц.Физлицо = КоличествоСтрок.Физлицо
	|ГДЕ
	|	КоличествоСтрок.РазныхСтрок = 1
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиФизлиц.Физлицо,
	|	СтрокиФизлиц.ПодразделениеОрганизации
	|ИЗ
	|	ВТСтрокиФизлиц КАК СтрокиФизлиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТКоличествоСтрок КАК КоличествоСтрок
	|		ПО СтрокиФизлиц.Физлицо = КоличествоСтрок.Физлицо
	|ГДЕ
	|	КоличествоСтрок.РазныхСтрок > 1
	|	И СтрокиФизлиц.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТФизлицаВсеРаботники.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТФизлицаРаботникиПодразделения
	|ИЗ
	|	ВТФизлицаВсеРаботники КАК ВТФизлицаВсеРаботники
	|ГДЕ
	|	ВТФизлицаВсеРаботники.ПодразделениеОрганизации В(&парамМассивПодразделений)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТФизлицаВсеРаботники.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТФизлицаРаботникиДругихПодразделений
	|ИЗ
	|	ВТФизлицаВсеРаботники КАК ВТФизлицаВсеРаботники
	|ГДЕ
	|	(НЕ ВТФизлицаВсеРаботники.ПодразделениеОрганизации В (&парамМассивПодразделений))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДополнительныеНачисления.ФизЛицо,
	|	МАКСИМУМ(ДополнительныеНачисления.ПодразделениеОрганизации) КАК ПодразделениеОрганизации
	|ПОМЕСТИТЬ ВТСписокВсехДоговорников
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|ГДЕ
	|	НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &НачалоПериода
	|	И ДополнительныеНачисления.ДокументОснование ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом
	|	И ДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	|
	|СГРУППИРОВАТЬ ПО
	|	ДополнительныеНачисления.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТСписокВсехДоговорников.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТСписокФизлицПодразделения
	|ИЗ
	|	ВТСписокВсехДоговорников КАК ВТСписокВсехДоговорников
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФизлицаРаботникиДругихПодразделений КАК ВТФизлицаРаботникиДругихПодразделений
	|		ПО ВТСписокВсехДоговорников.ФизЛицо = ВТФизлицаРаботникиДругихПодразделений.Физлицо
	|ГДЕ
	|	ВТФизлицаРаботникиДругихПодразделений.Физлицо ЕСТЬ NULL 
	|	И ВТСписокВсехДоговорников.ПодразделениеОрганизации В(&парамМассивПодразделений)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ВТФизлицаРаботникиПодразделения.Физлицо
	|ИЗ
	|	ВТФизлицаРаботникиПодразделения КАК ВТФизлицаРаботникиПодразделения
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
	|	ВТСписокВсехФизлиц.ФизЛицо
	|ИЗ
	|	ВТСписокФизлицПодразделения КАК ВТСписокВсехФизлиц
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
	|		ПО ВТСписокВсехФизлиц.ФизЛицо = СотрудникиОрганизаций.Физлицо
	|			И (СотрудникиОрганизаций.Организация = &парамГоловнаяОрганизация)";
	
	Запрос.Текст = ТекстЗапроса;
	
    Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции // ПолучитьОграничениеНаСотрудников()

// Предназначена для получения выборки из запроса с данными расчета 
// По текущему регистратору получает 
//    	данные о начисленной зарплате в разрезе кодов дохода 
// 		данные об инвалидности физлиц помесячно
//		присоединяет данные о скидках к доходам
//
// Параметры:
//  нет
// Возвращаемое значение:
//  Выборка результата запроса
//
Функция ПолучитьДанныеРасчетаЗа2010Год(ГоловнаяОрганизация, ОрганичениеНаСотрудников, ДанныеОДоходах, Отказ)
	
	Если Отказ Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	// расчет вызван независимо от получения данных о доходах,
	// получим список сотрудников для расчета 
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		ОрганичениеНаСотрудников = ПолучитьОграничениеНаСотрудников(Отказ);	
		Если Отказ Тогда
			Возврат Неопределено;
		КонецЕсли;
	КонецЕсли;
	
	Запрос = Новый Запрос();
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГодРасчета", Год(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамМесяцРасчета", Месяц(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПредыдущийМесяц", Месяц(ПериодРегистрации) - 1);
	Запрос.УстановитьПараметр("парамПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Регистратор", Ссылка);
	ПредельнаяСумма = РегистрыСведений.ПредельнаяВеличинаБазыСтраховыхВзносов.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации)).Размер;
	Запрос.УстановитьПараметр("ПредельнаяСумма", ?(ЗначениеЗаполнено(ПредельнаяСумма),ПредельнаяСумма,0));
	Ставка = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации), Новый Структура("Организация", Организация)).Ставка;
	Запрос.УстановитьПараметр("СтавкаВзносаФСС_НС_ПЗ", Ставка / 100);
	Запрос.УстановитьПараметр("парамЭтоЮрЛицо", ОбщегоНазначенияПереопределяемый.ЭтоЮрЛицо(Организация));
	
	// ---------------------------------------------------------------------------
	// тексты запросов
	//

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.ОблагаетсяЕНВД,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ВидДохода,
	|	СведенияОДоходах.Результат - СведенияОДоходах.Скидка КАК ОблагаемыйДоход
	|ПОМЕСТИТЬ ВТДанныеДокумента
	|ИЗ
	|	&ДанныеОДоходах КАК СведенияОДоходах";
	Запрос.УстановитьПараметр("ДанныеОДоходах", ДанныеОДоходах);
	Запрос.Выполнить();
	
	// ФизлицаДляРасчета
	//
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
		|ПОМЕСТИТЬ ВТСписокСотрудников
		|ИЗ
		|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &парамПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо
		|ИЗ
		|	ВТДанныеДокумента КАК СведенияОДоходах
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо";
		Запрос.Выполнить();
		
	Иначе
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
        |   ТаблицаСотрудников.ФизЛицо КАК ФизЛицо
        |ПОМЕСТИТЬ ВТСписокСотрудников
        |ИЗ
        |   &парамТаблицаСотрудников КАК ТаблицаСотрудников
        |
        |ИНДЕКСИРОВАТЬ ПО
        |   ФизЛицо";
		Запрос.УстановитьПараметр("парамТаблицаСотрудников", ОрганичениеНаСотрудников);
		Запрос.Выполнить();
	КонецЕсли;
	
	// Периоды
	// Таблица список периодов
	// Поля:
	//		Период
	// Описание:
	//  список периодов - первые даты месяцев с начала года по "текущий" для запроса период
	//
	
	// конец месяца налогового периода
	КонецМесяца = КонецМесяца(НачалоГода(ПериодРегистрации));
	// первый месяц
	ПериодыТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период ПОМЕСТИТЬ ВТПериоды";
	// прибавим остальные месяцы
	Для Сч = 2 По Месяц(ПериодРегистрации) Цикл
		КонецМесяца = КонецМесяца(КонецМесяца+1);
    	ПериодыТекст = ПериодыТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	Запрос.Текст = ПериодыТекст;
	Запрос.Выполнить();

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ЕСТЬNULL(УчетнаяПолитикаНалоговыйУчет.ВидТарифаСтраховыхВзносов, ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОбщийНалоговыйРежим)) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТИспользуемыеТарифы
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		МАКСИМУМ(УчетнаяПолитикаНалоговыйУчет.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|			ПО Периоды.Период >= УчетнаяПолитикаНалоговыйУчет.Период
	|				И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Период) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|		ПО Периоды.ПериодРегистра = УчетнаяПолитикаНалоговыйУчет.Период
	|			И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТарифСтраховыхВзносовСрезПоследних.ВидТарифа КАК ВидТарифа,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФР,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФРНакопительная,
	|	ТарифСтраховыхВзносовСрезПоследних.ФСС,
	|	ТарифСтраховыхВзносовСрезПоследних.ФФОМС,
	|	ТарифСтраховыхВзносовСрезПоследних.ТФОМС
	|ПОМЕСТИТЬ ВТТарифы
	|ИЗ
	|	РегистрСведений.ТарифСтраховыхВзносов.СрезПоследних(&парамКонецГода, ) КАК ТарифСтраховыхВзносовСрезПоследних
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидТарифа
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|	ЕСТЬNULL(ГражданствоФизЛиц.НеИмеетПравоНаПенсию, ЛОЖЬ) КАК НеИмеетПравоНаПенсию
	|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|			ПО Периоды.Период >= ГражданствоФизЛиц.Период
	|	ГДЕ
	|		ГражданствоФизЛиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ГражданствоФизЛиц.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|		ПО Периоды.ПериодРегистра = ГражданствоФизЛиц.Период
	|			И Периоды.Физлицо = ГражданствоФизЛиц.ФизЛицо
	|			И ГражданствоФизЛиц.НеИмеетПравоНаПенсию
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|	СведенияОбИнвалидностиФизлиц.Период КАК Период,
	|	СведенияОбИнвалидностиФизлиц.Инвалидность
	|ПОМЕСТИТЬ ВТ_СведенияОбИнвалидности
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|ГДЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТДанныеОбИнвалидности
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|		МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|			ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СведенияОбИнвалидностиФизлиц.Физлицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|		ПО (СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра)
	|			И Периоды.Физлицо = СведенияОбИнвалидностиФизлиц.Физлицо
	|			И (СведенияОбИнвалидностиФизлиц.Инвалидность)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.ОблагаетсяЕНВД,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуПФР КАК ВходитВБазуПФР,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФСС КАК ВходитВБазуФСС,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФОМС КАК ВходитВБазуФОМС,
	|	СведенияОДоходах.РезультатОборот - СведенияОДоходах.СкидкаОборот КАК ОблагаемыйДоход
	|ПОМЕСТИТЬ ВТДоходыПоФизлицамМесяцам
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах.Обороты(
	|			&парамНачалоГода,
	|			&парамКонецМесяцаПериодаРегистрации,
	|			Месяц,
	|			Организация = &парамГоловнаяОрганизация
	|				И Физлицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТСписокСотрудников КАК СписокСотрудников)) КАК СведенияОДоходах
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СтраховыеВзносыСведенияОДоходах.Период),
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	-СтраховыеВзносыСведенияОДоходах.Результат + СтраховыеВзносыСведенияОДоходах.Скидка
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СтраховыеВзносыСведенияОДоходах
	|ГДЕ
	|	СтраховыеВзносыСведенияОДоходах.Регистратор = &Регистратор
	|	И СтраховыеВзносыСведенияОДоходах.Организация = &парамГоловнаяОрганизация
	|	И СтраховыеВзносыСведенияОДоходах.ФизЛицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	СтраховыеВзносыСведенияОДоходах.Месяц,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаемыйДоход
	|ИЗ
	|	ВТДанныеДокумента КАК СтраховыеВзносыСведенияОДоходах
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТФизлицаБезОблагаемойБазы
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК СведенияОДоходах
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫБОР
	|			КОГДА СведенияОДоходах.ВходитВБазуПФР
	|					ИЛИ СведенияОДоходах.ВходитВБазуФОМС
	|				ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) < 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|	МЕСЯЦ(РанееИсчисленныеВзносы.Период) КАК Месяц,
	|	РанееИсчисленныеВзносы.ФССОборот,
	|	РанееИсчисленныеВзносы.ФФОМСОборот,
	|	РанееИсчисленныеВзносы.ТФОМСОборот,
	|	РанееИсчисленныеВзносы.ПФРНакопительнаяОборот,
	|	РанееИсчисленныеВзносы.ПФРСтраховаяОборот,
	|	РанееИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот,
	|	РанееИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот,
	|	РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот
	|ПОМЕСТИТЬ ВТРанееИсчисленныеВзносыПоМесяцам
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыИсчисленные.Обороты(
	|			&парамНачалоГода,
	|			&парамКонецМесяцаПериодаРегистрации,
	|			Месяц,
	|			Организация = &парамГоловнаяОрганизация
	|				И (НЕ ФизЛицо В
	|						(ВЫБРАТЬ
	|							СписокСотрудников.ФизЛицо
	|						ИЗ
	|							ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|				И ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТСписокСотрудников КАК СписокСотрудников)) КАК РанееИсчисленныеВзносы
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыИсчисленные.ФизЛицо,
	|	МЕСЯЦ(СтраховыеВзносыИсчисленные.Период),
	|	-СтраховыеВзносыИсчисленные.ФСС,
	|	-СтраховыеВзносыИсчисленные.ФФОМС,
	|	-СтраховыеВзносыИсчисленные.ТФОМС,
	|	-СтраховыеВзносыИсчисленные.ПФРНакопительная,
	|	-СтраховыеВзносыИсчисленные.ПФРСтраховая,
	|	-СтраховыеВзносыИсчисленные.ПФРНакопительнаяЕНВД,
	|	-СтраховыеВзносыИсчисленные.ПФРСтраховаяЕНВД,
	|	-СтраховыеВзносыИсчисленные.ПФРПоДополнительномуТарифу
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыИсчисленные КАК СтраховыеВзносыИсчисленные
	|ГДЕ
	|	СтраховыеВзносыИсчисленные.Регистратор = &Регистратор
	|	И СтраховыеВзносыИсчисленные.Организация = &парамГоловнаяОрганизация
	|	И (НЕ СтраховыеВзносыИсчисленные.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|	И СтраховыеВзносыИсчисленные.ФизЛицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ФССОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ФССОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ФФОМСОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ФФОМСОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ТФОМСОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ТФОМСОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ФССОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ФССОборотИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ФФОМСОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ФФОМСОборотИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ТФОМСОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ТФОМСОборотИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРНакопительнаяОборот + РанееИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРНакопительнаяОборотИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРСтраховаяОборот + РанееИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРСтраховаяОборотИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРНакопительнаяОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРНакопительнаяОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРСтраховаяОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРСтраховаяОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРНакопительнаяЕНВДОборот,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|				ТОГДА РанееИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПФРСтраховаяЕНВДОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот) КАК ПФРПоДополнительномуТарифуОборот
	|ПОМЕСТИТЬ ВТРанееИсчисленныеВзносы
	|ИЗ
	|	ВТРанееИсчисленныеВзносыПоМесяцам КАК РанееИсчисленныеВзносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|		ПО РанееИсчисленныеВзносы.ФизЛицо = Инвалид.Физлицо
	|			И РанееИсчисленныеВзносы.Месяц = Инвалид.Месяц
	|
	|СГРУППИРОВАТЬ ПО
	|	РанееИсчисленныеВзносы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Основная.ФизЛицо КАК ФизЛицо,
	|	Основная.Месяц КАК Месяц,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФР,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|					И Основная.ОблагаетсяЕНВД
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРИнвалидаЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|				ТОГДА 0
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРПоОсновномуТарифу,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФССИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|				ТОГДА 0
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФССПоОсновномуТарифу,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФССЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМСИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|				ТОГДА 0
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМСПоОсновномуТарифу,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ТОГДА 0
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И (Иностр.Физлицо ЕСТЬ NULL 
	|						ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМСЕНВД
	|ПОМЕСТИТЬ ВТДоходыЗастрахованныхЛиц
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК Основная
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОПравеНаПенсию КАК Иностр
	|		ПО Основная.ФизЛицо = Иностр.Физлицо
	|			И Основная.Месяц = Иностр.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|		ПО Основная.ФизЛицо = Инвалид.Физлицо
	|			И Основная.Месяц = Инвалид.Месяц
	|ГДЕ
	|	(НЕ Основная.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	Основная.ФизЛицо,
	|	Основная.Месяц
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ДоходыЗастрахованныхЛиц.ФизЛицо КАК ФизЛицо,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаПФР) КАК БазаПФР,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФСС) КАК БазаФСС,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФОМС) КАК БазаФОМС
	|ПОМЕСТИТЬ ВТНакопленнаяОблагаемаяБаза
	|ИЗ
	|	ВТПериоды КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|		ПО (ДоходыЗастрахованныхЛиц.Месяц МЕЖДУ 1 И МЕСЯЦ(Периоды.Период))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыЗастрахованныхЛиц.ФизЛицо,
	|	МЕСЯЦ(Периоды.Период)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыЗастрахованныхЛиц.ФизЛицо КАК ФизЛицо,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаПФРИнвалида) КАК БазаПФРИнвалидаВсего,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаПФРИнвалидаЕНВД) КАК БазаПФРИнвалидаЕНВД
	|ПОМЕСТИТЬ ВТБазаПФРПоИнвалидам
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|ГДЕ
	|	ДоходыЗастрахованныхЛиц.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыЗастрахованныхЛиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	База.Месяц КАК Месяц,
	|	База.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА База.БазаПФР <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаПФР = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0)
	|			ТОГДА 1
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0)) / (База.БазаПФР - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияПФР,
	|	ВЫБОР
	|		КОГДА База.БазаФСС <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаФСС = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0)
	|			ТОГДА 1
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0)) / (База.БазаФСС - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияФСС,
	|	ВЫБОР
	|		КОГДА База.БазаФОМС <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаФОМС = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0)
	|			ТОГДА 1
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0)) / (База.БазаФОМС - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияФОМС
	|ПОМЕСТИТЬ ВТКоэффициентыДостиженияПредельнойСуммы
	|ИЗ
	|	ВТНакопленнаяОблагаемаяБаза КАК База
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленнаяОблагаемаяБаза КАК НакопленоПоПрошлыйМесяц
	|		ПО (База.Месяц - 1 = НакопленоПоПрошлыйМесяц.Месяц)
	|			И База.ФизЛицо = НакопленоПоПрошлыйМесяц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыЗастрахованныхЛиц.ФизЛицо КАК ФизЛицо,
	|	ДоходыЗастрахованныхЛиц.Месяц КАК Месяц,
	|	ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаПФРИнвалида
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФРИнвалида = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|	КОНЕЦ КАК БазаПФРИнвалида,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФРЕНВД = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|		ИНАЧЕ ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)) * ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаПФРЕНВД) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК БазаПФРПоОсновномуТарифу,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаПФРЕНВД
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФРЕНВД = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0) - (ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)) * ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаПФРПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаПФРЕНВД) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК БазаПФРЕНВД,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФССИнвалида
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФССИнвалида = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|	КОНЕЦ КАК БазаФССИнвалида,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФССЕНВД = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|		ИНАЧЕ ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)) * ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаФССЕНВД) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК БазаФССПоОсновномуТарифу,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФССЕНВД
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФССЕНВД = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0) - (ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)) * ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаФССПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаФССЕНВД) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК БазаФССЕНВД,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФОМСИнвалида
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМСИнвалида = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|	КОНЕЦ КАК БазаФОМСИнвалида,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМСЕНВД = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|		ИНАЧЕ ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)) * ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаФОМСЕНВД) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК БазаФОМСПоОсновномуТарифу,
	|	ВЫБОР
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 1
	|			ТОГДА ДоходыЗастрахованныхЛиц.БазаФОМСЕНВД
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМСЕНВД = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу = 0
	|			ТОГДА &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0) - (ВЫРАЗИТЬ((&ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)) * ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу / (ДоходыЗастрахованныхЛиц.БазаФОМСПоОсновномуТарифу + ДоходыЗастрахованныхЛиц.БазаФОМСЕНВД) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК БазаФОМСЕНВД
	|ПОМЕСТИТЬ ВТОграниченнаяОблагаемаяБаза
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТКоэффициентыДостиженияПредельнойСуммы КАК Коэффициенты
	|		ПО ДоходыЗастрахованныхЛиц.ФизЛицо = Коэффициенты.ФизЛицо
	|			И ДоходыЗастрахованныхЛиц.Месяц = Коэффициенты.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленнаяОблагаемаяБаза КАК НакопленнаяОблагаемаяБазаПоПредыдущийМесяц
	|		ПО ДоходыЗастрахованныхЛиц.ФизЛицо = НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.ФизЛицо
	|			И (ДоходыЗастрахованныхЛиц.Месяц - 1 = НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.Месяц)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИспользуемыеТарифы КАК ИспользуемыеТарифы
	|		ПО ДоходыЗастрахованныхЛиц.Месяц = ИспользуемыеТарифы.Месяц
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * ОсновнойТариф.ПФРНакопительная / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРНакопительная,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * ОсновнойТариф.ПФР / 100 КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * (ОсновнойТариф.ПФР - ОсновнойТариф.ПФРНакопительная) / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРСтраховая,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФССПоОсновномуТарифу) * ОсновнойТариф.ФСС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФСС,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСПоОсновномуТарифу) * ОсновнойТариф.ФФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФФОМС,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСПоОсновномуТарифу) * ОсновнойТариф.ТФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатТФОМС
	|ПОМЕСТИТЬ ВТИсчисленоПоОсновномуТарифу
	|ИЗ
	|	ВТОграниченнаяОблагаемаяБаза КАК ОграниченнаяОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ОсновнойТариф
	|		ПО ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ОсновнойТариф.ВидТарифа
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновнойТариф.ПФРНакопительная,
	|	ОсновнойТариф.ПФР,
	|	ОсновнойТариф.ФСС,
	|	ОсновнойТариф.ФФОМС,
	|	ОсновнойТариф.ТФОМС,
	|	ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * ТарифИнвалида.ПФРНакопительная / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРНакопительнаяИнвалида,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * ТарифИнвалида.ПФР / 100 КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * (ТарифИнвалида.ПФР - ТарифИнвалида.ПФРНакопительная) / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРСтраховаяИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФССИнвалида) * ТарифИнвалида.ФСС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФССИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСИнвалида) * ТарифИнвалида.ФФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФФОМСИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСИнвалида) * ТарифИнвалида.ТФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатТФОМСИнвалида,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРЕНВД) * ТарифЕНВД.ПФРНакопительная / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРНакопительнаяЕНВД,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРЕНВД) * ТарифЕНВД.ПФР / 100 КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРЕНВД) * (ТарифЕНВД.ПФР - ТарифЕНВД.ПФРНакопительная) / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРСтраховаяЕНВД
	|ПОМЕСТИТЬ ВТИсчисленоПоЛьготномуТарифу
	|ИЗ
	|	ВТОграниченнаяОблагаемаяБаза КАК ОграниченнаяОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ТарифЕНВД
	|		ПО (ТарифЕНВД.ВидТарифа = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ЕНВД))
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ТарифИнвалида
	|		ПО (ТарифИнвалида.ВидТарифа = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|
	|СГРУППИРОВАТЬ ПО
	|	ТарифИнвалида.ПФРНакопительная,
	|	ТарифИнвалида.ПФР,
	|	ТарифИнвалида.ФСС,
	|	ТарифИнвалида.ФФОМС,
	|	ТарифИнвалида.ТФОМС,
	|	ТарифЕНВД.ПФРНакопительная,
	|	ТарифЕНВД.ПФР,
	|	ТарифЕНВД.ФСС,
	|	ТарифЕНВД.ФФОМС,
	|	ТарифЕНВД.ТФОМС,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(ДоходыФизлиц.ОблагаемыйДоход) * 0.14 КАК ЧИСЛО(15, 2)) КАК РезультатПоДополнительномуТарифу,
	|	ДоходыФизлиц.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТВзносыПоДополнительномуТарифу
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК ДоходыФизлиц
	|ГДЕ
	|	ДоходыФизлиц.ОблагаетсяПоДополнительномуТарифу
	|	И ДоходыФизлиц.ВходитВБазуПФР
	|	И (НЕ ДоходыФизлиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Начислено.ФизЛицо КАК ФизЛицо,
	|	СУММА(Начислено.ОблагаемаяБаза) КАК ОблагаемаяБаза,
	|	СУММА(Начислено.ОблагаемаяБазаИнвалида) КАК ОблагаемаяБазаИнвалида,
	|	ВЫРАЗИТЬ(СУММА(Начислено.ОблагаемаяБаза) * &СтавкаВзносаФСС_НС_ПЗ КАК ЧИСЛО(15, 2)) КАК Взносов,
	|	ВЫРАЗИТЬ(СУММА(Начислено.ОблагаемаяБазаИнвалида) * &СтавкаВзносаФСС_НС_ПЗ * 0.6 КАК ЧИСЛО(15, 2)) КАК ВзносовПоИнвалидам
	|ПОМЕСТИТЬ ВТБазаВзносовФСС_НС_ПЗ
	|ИЗ
	|	(ВЫБРАТЬ
	|		БазовыеНачисленияФССНС.ФизЛицо КАК ФизЛицо,
	|		ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|						И ОсновнойТариф.ВидТарифаСтраховыхВзносов <> ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|					ИЛИ (НЕ &парамЭтоЮрЛицо)
	|				ТОГДА БазовыеНачисленияФССНС.Результат
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ОблагаемаяБаза,
	|		ВЫБОР
	|			КОГДА (Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					ИЛИ ОсновнойТариф.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|					И &парамЭтоЮрЛицо
	|				ТОГДА БазовыеНачисленияФССНС.Результат
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ОблагаемаяБазаИнвалида
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК БазовыеНачисленияФССНС
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|			ПО БазовыеНачисленияФССНС.ФизЛицо = Инвалид.Физлицо
	|				И (Инвалид.Месяц = &парамМесяцРасчета)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТИспользуемыеТарифы КАК ОсновнойТариф
	|			ПО (ОсновнойТариф.Месяц = &парамМесяцРасчета)
	|	ГДЕ
	|		БазовыеНачисленияФССНС.ПериодРегистрации = &парамПериодРегистрации
	|		И &парамДопУсловие
	|		И БазовыеНачисленияФССНС.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|		И (НЕ БазовыеНачисленияФССНС.ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|		И БазовыеНачисленияФССНС.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)
	|		И БазовыеНачисленияФССНС.ВидРасчета.КодДоходаФСС_НС = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БазовыеНачисленияФССНС.ФизЛицо,
	|		ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ NULL 
	|						И ОсновнойТариф.ВидТарифаСтраховыхВзносов <> ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|					ИЛИ (НЕ &парамЭтоЮрЛицо)
	|				ТОГДА БазовыеНачисленияФССНС.Результат
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА (Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					ИЛИ ОсновнойТариф.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|					И &парамЭтоЮрЛицо
	|				ТОГДА БазовыеНачисленияФССНС.Результат
	|			ИНАЧЕ 0
	|		КОНЕЦ
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК БазовыеНачисленияФССНС
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|			ПО БазовыеНачисленияФССНС.ФизЛицо = Инвалид.Физлицо
	|				И (Инвалид.Месяц = &парамМесяцРасчета)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТИспользуемыеТарифы КАК ОсновнойТариф
	|			ПО (ОсновнойТариф.Месяц = &парамМесяцРасчета)
	|	ГДЕ
	|		НАЧАЛОПЕРИОДА(БазовыеНачисленияФССНС.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
	|		И &парамДопУсловие
	|		И БазовыеНачисленияФССНС.ВидРасчета.КодДоходаФСС_НС = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
	|		И (НЕ БазовыеНачисленияФССНС.ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|		И БазовыеНачисленияФССНС.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)
	|		И БазовыеНачисленияФССНС.ОбособленноеПодразделение = &парамОбособленноеПодразделение) КАК Начислено
	|
	|СГРУППИРОВАТЬ ПО
	|	Начислено.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МАКСИМУМ(БазаВзносовФСС_НС_ПЗ.ОблагаемаяБаза) КАК МаксимумБазы,
	|	МАКСИМУМ(БазаВзносовФСС_НС_ПЗ.ОблагаемаяБазаИнвалида) КАК МаксимумБазыИнвалида
	|ПОМЕСТИТЬ ВТМаксимумыОблагаемойБазыПоНС_ПЗ
	|ИЗ
	|	ВТБазаВзносовФСС_НС_ПЗ КАК БазаВзносовФСС_НС_ПЗ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МАКСИМУМ(БазаВзносовФСС_НС_ПЗ.ФизЛицо) КАК ФизЛицо,
	|	МАКСИМУМ(БазаВзносовФСС_НС_ПЗИнвалида.ФизЛицо) КАК ФизЛицоИнвалид
	|ПОМЕСТИТЬ ВТФизлицаОкругления
	|ИЗ
	|	ВТМаксимумыОблагаемойБазыПоНС_ПЗ КАК Максимумы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаВзносовФСС_НС_ПЗ КАК БазаВзносовФСС_НС_ПЗ
	|		ПО (Максимумы.МаксимумБазы > 0)
	|			И Максимумы.МаксимумБазы = БазаВзносовФСС_НС_ПЗ.ОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаВзносовФСС_НС_ПЗ КАК БазаВзносовФСС_НС_ПЗИнвалида
	|		ПО (Максимумы.МаксимумБазыИнвалида > 0)
	|			И Максимумы.МаксимумБазыИнвалида = БазаВзносовФСС_НС_ПЗИнвалида.ОблагаемаяБазаИнвалида
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(БазаВзносовФСС_НС_ПЗ.ОблагаемаяБаза) * &СтавкаВзносаФСС_НС_ПЗ КАК ЧИСЛО(15, 2)) КАК РассчитаноВзносов,
	|	ВЫРАЗИТЬ(СУММА(БазаВзносовФСС_НС_ПЗ.ОблагаемаяБазаИнвалида) * &СтавкаВзносаФСС_НС_ПЗ * 0.6 КАК ЧИСЛО(15, 2)) КАК РассчитаноВзносовПоИнвалидам,
	|	СУММА(ВЫБОР
	|			КОГДА БазаВзносовФСС_НС_ПЗ.ФизЛицо = ФизлицоОкругления.ФизЛицо
	|				ТОГДА 0
	|			ИНАЧЕ БазаВзносовФСС_НС_ПЗ.Взносов
	|		КОНЕЦ) КАК ПросуммированоВзносов,
	|	СУММА(ВЫБОР
	|			КОГДА БазаВзносовФСС_НС_ПЗ.ФизЛицо = ФизлицоОкругления.ФизЛицоИнвалид
	|				ТОГДА 0
	|			ИНАЧЕ БазаВзносовФСС_НС_ПЗ.ВзносовПоИнвалидам
	|		КОНЕЦ) КАК ПросуммированоВзносовПоИнвалидам
	|ПОМЕСТИТЬ ВТИтогоВзносовФСС_НС_ПЗ
	|ИЗ
	|	ВТБазаВзносовФСС_НС_ПЗ КАК БазаВзносовФСС_НС_ПЗ
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФизлицаОкругления КАК ФизлицоОкругления
	|		ПО (ИСТИНА)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	БазаВзносовФСС_НС_ПЗ.ФизЛицо КАК ФизЛицо,
	|	БазаВзносовФСС_НС_ПЗ.Взносов + БазаВзносовФСС_НС_ПЗ.ВзносовПоИнвалидам КАК Взносов
	|ПОМЕСТИТЬ ВТВзносыФС_НС_ПЗ
	|ИЗ
	|	ВТБазаВзносовФСС_НС_ПЗ КАК БазаВзносовФСС_НС_ПЗ
	|ГДЕ
	|	(НЕ БазаВзносовФСС_НС_ПЗ.ФизЛицо В
	|				(ВЫБРАТЬ
	|					ФизлицоОкругления.ФизЛицо
	|				ИЗ
	|					ВТФизлицаОкругления КАК ФизлицоОкругления
	|				ГДЕ
	|					ФизлицоОкругления.ФизЛицо <> ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|		
	|				ОБЪЕДИНИТЬ ВСЕ
	|		
	|				ВЫБРАТЬ
	|					ФизлицоОкругления.ФизЛицоИнвалид
	|				ИЗ
	|					ВТФизлицаОкругления КАК ФизлицоОкругления
	|				ГДЕ
	|					ФизлицоОкругления.ФизЛицоИнвалид <> ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)))
	|	И БазаВзносовФСС_НС_ПЗ.Взносов + БазаВзносовФСС_НС_ПЗ.ВзносовПоИнвалидам <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ФизлицоОкругления.ФизЛицо,
	|	ИтогоВзносовФСС_НС_ПЗ.РассчитаноВзносов - ИтогоВзносовФСС_НС_ПЗ.ПросуммированоВзносов
	|ИЗ
	|	ВТФизлицаОкругления КАК ФизлицоОкругления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИтогоВзносовФСС_НС_ПЗ КАК ИтогоВзносовФСС_НС_ПЗ
	|		ПО (ИСТИНА)
	|ГДЕ
	|	ИтогоВзносовФСС_НС_ПЗ.РассчитаноВзносов <> ИтогоВзносовФСС_НС_ПЗ.ПросуммированоВзносов
	|	И ФизлицоОкругления.ФизЛицо <> ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ФизлицоОкругления.ФизЛицоИнвалид,
	|	ИтогоВзносовФСС_НС_ПЗ.РассчитаноВзносовПоИнвалидам - ИтогоВзносовФСС_НС_ПЗ.ПросуммированоВзносовПоИнвалидам
	|ИЗ
	|	ВТФизлицаОкругления КАК ФизлицоОкругления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИтогоВзносовФСС_НС_ПЗ КАК ИтогоВзносовФСС_НС_ПЗ
	|		ПО (ИСТИНА)
	|ГДЕ
	|	ИтогоВзносовФСС_НС_ПЗ.РассчитаноВзносовПоИнвалидам <> ИтогоВзносовФСС_НС_ПЗ.ПросуммированоВзносовПоИнвалидам
	|	И ФизлицоОкругления.ФизЛицоИнвалид <> ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыИсчисленныеОбороты.ФизЛицо,
	|	-СтраховыеВзносыИсчисленныеОбороты.ФССНесчастныеСлучаиОборот
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыИсчисленные.Обороты(
	|			&парамПериодРегистрации,
	|			&парамКонецМесяцаПериодаРегистрации,
	|			,
	|			(НЕ ФизЛицо В
	|						(ВЫБРАТЬ
	|							СписокСотрудников.ФизЛицо
	|						ИЗ
	|							ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|				И ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТСписокСотрудников КАК СписокСотрудников)
	|				И ОбособленноеПодразделение = &парамОбособленноеПодразделение) КАК СтраховыеВзносыИсчисленныеОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыИсчисленные.ФизЛицо,
	|	СтраховыеВзносыИсчисленные.ФССНесчастныеСлучаи
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыИсчисленные КАК СтраховыеВзносыИсчисленные
	|ГДЕ
	|	СтраховыеВзносыИсчисленные.Регистратор = &Регистратор
	|	И (НЕ СтраховыеВзносыИсчисленные.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|	И СтраховыеВзносыИсчисленные.ФизЛицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|	И СтраховыеВзносыИсчисленные.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВсегоИсчислено.ФизЛицо КАК ФизЛицо,
	|	ВсегоИсчислено.Порядок,
	|	СУММА(ВсегоИсчислено.РезультатПФРНакопительная) КАК РезультатПФРНакопительная,
	|	СУММА(ВсегоИсчислено.РезультатПФРСтраховая) КАК РезультатПФРСтраховая,
	|	СУММА(ВсегоИсчислено.РезультатПФРНакопительнаяЕНВД) КАК РезультатПФРНакопительнаяЕНВД,
	|	СУММА(ВсегоИсчислено.РезультатПФРСтраховаяЕНВД) КАК РезультатПФРСтраховаяЕНВД,
	|	СУММА(ВсегоИсчислено.РезультатФСС) КАК РезультатФСС,
	|	СУММА(ВсегоИсчислено.РезультатФФОМС) КАК РезультатФФОМС,
	|	СУММА(ВсегоИсчислено.РезультатТФОМС) КАК РезультатТФОМС,
	|	СУММА(ВсегоИсчислено.РезультатПФРНакопительнаяИнвалида) КАК РезультатПФРНакопительнаяИнвалида,
	|	СУММА(ВсегоИсчислено.РезультатПФРСтраховаяИнвалида) КАК РезультатПФРСтраховаяИнвалида,
	|	СУММА(ВсегоИсчислено.РезультатПоДополнительномуТарифу) КАК РезультатПоДополнительномуТарифу,
	|	СУММА(ВсегоИсчислено.РезультатФССНесчастныеСлучаи) КАК РезультатФССНесчастныеСлучаи
	|ПОМЕСТИТЬ ВТСуммыВзносовНарастающимИтогом
	|ИЗ
	|	(ВЫБРАТЬ
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо КАК ФизЛицо,
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо.Наименование КАК Порядок,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРНакопительная КАК РезультатПФРНакопительная,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРСтраховая КАК РезультатПФРСтраховая,
	|		ИсчисленоПоОсновномуТарифу.РезультатФСС КАК РезультатФСС,
	|		ИсчисленоПоОсновномуТарифу.РезультатФФОМС КАК РезультатФФОМС,
	|		ИсчисленоПоОсновномуТарифу.РезультатТФОМС КАК РезультатТФОМС,
	|		0 КАК РезультатПФРНакопительнаяЕНВД,
	|		0 КАК РезультатПФРСтраховаяЕНВД,
	|		0 КАК РезультатПФРНакопительнаяИнвалида,
	|		0 КАК РезультатПФРСтраховаяИнвалида,
	|		0 КАК РезультатПоДополнительномуТарифу,
	|		0 КАК РезультатФССНесчастныеСлучаи
	|	ИЗ
	|		ВТИсчисленоПоОсновномуТарифу КАК ИсчисленоПоОсновномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ИсчисленоПоЛьготномуТарифу.ФизЛицо,
	|		ИсчисленоПоЛьготномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		ИсчисленоПоЛьготномуТарифу.РезультатФССИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатФФОМСИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатТФОМСИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРНакопительнаяЕНВД,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРСтраховаяЕНВД,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРНакопительнаяИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРСтраховаяИнвалида,
	|		0,
	|		0
	|	ИЗ
	|		ВТИсчисленоПоЛьготномуТарифу КАК ИсчисленоПоЛьготномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыПоДополнительномуТарифу.ФизЛицо,
	|		ВзносыПоДополнительномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыПоДополнительномуТарифу.РезультатПоДополнительномуТарифу,
	|		0
	|	ИЗ
	|		ВТВзносыПоДополнительномуТарифу КАК ВзносыПоДополнительномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыФС_НС_ПЗ.ФизЛицо,
	|		ВзносыФС_НС_ПЗ.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыФС_НС_ПЗ.Взносов
	|	ИЗ
	|		ВТВзносыФС_НС_ПЗ КАК ВзносыФС_НС_ПЗ) КАК ВсегоИсчислено
	|
	|СГРУППИРОВАТЬ ПО
	|	ВсегоИсчислено.ФизЛицо,
	|	ВсегоИсчислено.Порядок
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СуммыНарастающимИтогом.ФизЛицо КАК ФизЛицо,
	|	СуммыНарастающимИтогом.Порядок КАК Порядок,
	|	СуммыНарастающимИтогом.РезультатФСС - ЕСТЬNULL(ИсчисленныеВзносы.ФССОборот, 0) - ЕСТЬNULL(ИсчисленныеВзносы.ФССОборотИнвалида, 0) КАК ФСС,
	|	СуммыНарастающимИтогом.РезультатФФОМС - ЕСТЬNULL(ИсчисленныеВзносы.ФФОМСОборот, 0) - ЕСТЬNULL(ИсчисленныеВзносы.ФФОМСОборотИнвалида, 0) КАК ФФОМС,
	|	СуммыНарастающимИтогом.РезультатТФОМС - ЕСТЬNULL(ИсчисленныеВзносы.ТФОМСОборот, 0) - ЕСТЬNULL(ИсчисленныеВзносы.ТФОМСОборотИнвалида, 0) КАК ТФОМС,
	|	СуммыНарастающимИтогом.РезультатПФРНакопительная - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборот, 0) + ВЫБОР
	|		КОГДА МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего <> 0
	|				И МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД <> 0
	|			ТОГДА ВЫРАЗИТЬ((СуммыНарастающимИтогом.РезультатПФРНакопительнаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборотИнвалида, 0)) * (МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего - МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД) / МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ СуммыНарастающимИтогом.РезультатПФРНакопительнаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборотИнвалида, 0)
	|	КОНЕЦ КАК ПФРНакопительная,
	|	СуммыНарастающимИтогом.РезультатПФРСтраховая - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборот, 0) + ВЫБОР
	|		КОГДА МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего <> 0
	|				И МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД <> 0
	|			ТОГДА ВЫРАЗИТЬ((СуммыНарастающимИтогом.РезультатПФРСтраховаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборотИнвалида, 0)) * (МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего - МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД) / МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ СуммыНарастающимИтогом.РезультатПФРСтраховаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборотИнвалида, 0)
	|	КОНЕЦ КАК ПФРСтраховая,
	|	СуммыНарастающимИтогом.РезультатПФРНакопительнаяЕНВД - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот, 0) + ВЫБОР
	|		КОГДА МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего <> 0
	|				И МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД <> 0
	|			ТОГДА СуммыНарастающимИтогом.РезультатПФРНакопительнаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборотИнвалида, 0) - (ВЫРАЗИТЬ((СуммыНарастающимИтогом.РезультатПФРНакопительнаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборотИнвалида, 0)) * (МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего - МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД) / МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего КАК ЧИСЛО(15, 2)))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПФРНакопительнаяЕНВД,
	|	СуммыНарастающимИтогом.РезультатПФРСтраховаяЕНВД - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот, 0) + ВЫБОР
	|		КОГДА МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего <> 0
	|				И МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД <> 0
	|			ТОГДА СуммыНарастающимИтогом.РезультатПФРСтраховаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборотИнвалида, 0) - (ВЫРАЗИТЬ((СуммыНарастающимИтогом.РезультатПФРСтраховаяИнвалида - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборотИнвалида, 0)) * (МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего - МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаЕНВД) / МесячнаяБазаПФРПоИнвалидам.БазаПФРИнвалидаВсего КАК ЧИСЛО(15, 2)))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПФРСтраховаяЕНВД,
	|	СуммыНарастающимИтогом.РезультатПоДополнительномуТарифу - ЕСТЬNULL(ИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот, 0) КАК ПоДополнительномуТарифу,
	|	СуммыНарастающимИтогом.РезультатФССНесчастныеСлучаи КАК ФССНесчастныеСлучаи
	|ПОМЕСТИТЬ ВТВзносыЗаМесяц
	|ИЗ
	|	ВТСуммыВзносовНарастающимИтогом КАК СуммыНарастающимИтогом
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРанееИсчисленныеВзносы КАК ИсчисленныеВзносы
	|		ПО СуммыНарастающимИтогом.ФизЛицо = ИсчисленныеВзносы.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаПФРПоИнвалидам КАК МесячнаяБазаПФРПоИнвалидам
	|		ПО СуммыНарастающимИтогом.ФизЛицо = МесячнаяБазаПФРПоИнвалидам.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Порядок
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Взносы.ФизЛицо,
	|	Взносы.ФСС,
	|	Взносы.ФФОМС,
	|	Взносы.ТФОМС,
	|	Взносы.ПФРНакопительная,
	|	Взносы.ПФРСтраховая,
	|	Взносы.ПФРНакопительнаяЕНВД,
	|	Взносы.ПФРСтраховаяЕНВД,
	|	Взносы.ПоДополнительномуТарифу КАК ПФРПоДополнительномуТарифу,
	|	Взносы.ФССНесчастныеСлучаи
	|ИЗ
	|	ВТВзносыЗаМесяц КАК Взносы
	|ГДЕ
	|	(Взносы.ФСС <> 0
	|			ИЛИ Взносы.ФФОМС <> 0
	|			ИЛИ Взносы.ТФОМС <> 0
	|			ИЛИ Взносы.ПФРНакопительная <> 0
	|			ИЛИ Взносы.ПФРСтраховая <> 0
	|			ИЛИ Взносы.ПФРНакопительнаяЕНВД <> 0
	|			ИЛИ Взносы.ПФРСтраховаяЕНВД <> 0
	|			ИЛИ Взносы.ПоДополнительномуТарифу <> 0
	|			ИЛИ Взносы.ФССНесчастныеСлучаи <> 0)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Взносы.Порядок";
	
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"И &парамДопУсловие",РасчетСтраховыхВзносовПереопределяемый.ПолучитьДополнительноеУсловиеЗапросаБазаФСС_НС());
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"РегистрСведений.УчетнаяПолитикаНалоговыйУчет", ЗаполнениеРегламентированнойОтчетностиПереопределяемый.ИмяУчетнойПолитики());
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции  // ПолучитьДанныеРасчетаЗа2010Год

// Предназначена для получения выборки из запроса с данными расчета 
// По текущему регистратору получает 
//    	данные о начисленной зарплате в разрезе кодов дохода 
// 		данные об инвалидности физлиц помесячно
//		присоединяет данные о скидках к доходам
//
// Параметры:
//  нет
// Возвращаемое значение:
//  Выборка результата запроса
//
Функция ПолучитьДанныеРасчетаЗа2011Год(ГоловнаяОрганизация, ОрганичениеНаСотрудников, ДанныеОДоходах, Отказ)
	
	Если Отказ Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	// расчет вызван независимо от получения данных о доходах,
	// получим список сотрудников для расчета 
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		ОрганичениеНаСотрудников = ПолучитьОграничениеНаСотрудников(Отказ);	
		Если Отказ Тогда
			Возврат Неопределено;
		КонецЕсли;
	КонецЕсли;
	
	Запрос = Новый Запрос();
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГодРасчета", Год(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамМесяцРасчета", Месяц(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПредыдущийМесяц", Месяц(ПериодРегистрации) - 1);
	Запрос.УстановитьПараметр("парамПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамЭтоЮрЛицо", ОбщегоНазначенияПереопределяемый.ЭтоЮрЛицо(Организация));
	Запрос.УстановитьПараметр("Регистратор", Ссылка);
	ПредельнаяСумма = РегистрыСведений.ПредельнаяВеличинаБазыСтраховыхВзносов.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации)).Размер;
	Запрос.УстановитьПараметр("ПредельнаяСумма", ?(ЗначениеЗаполнено(ПредельнаяСумма),ПредельнаяСумма,0));
	Ставка = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации), Новый Структура("Организация", Организация)).Ставка;
	Запрос.УстановитьПараметр("СтавкаВзносаФСС_НС_ПЗ", Ставка / 100);
	
	// ---------------------------------------------------------------------------
	// тексты запросов
	//

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ВидДохода,
	|	СведенияОДоходах.Результат - СведенияОДоходах.Скидка КАК ОблагаемыйДоход,
	|	СведенияОДоходах.ОблагаетсяЕНВД
	|ПОМЕСТИТЬ ВТДанныеДокумента
	|ИЗ
	|	&ДанныеОДоходах КАК СведенияОДоходах";
	Запрос.УстановитьПараметр("ДанныеОДоходах", ДанныеОДоходах);
	Запрос.Выполнить();
	
	// ФизлицаДляРасчета
	//
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
		|ПОМЕСТИТЬ ВТСписокСотрудников
		|ИЗ
		|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &парамПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо
		|ИЗ
		|	ВТДанныеДокумента КАК СведенияОДоходах
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо";
		Запрос.Выполнить();
		
	Иначе
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
        |   ТаблицаСотрудников.ФизЛицо КАК ФизЛицо
        |ПОМЕСТИТЬ ВТСписокСотрудников
        |ИЗ
        |   &парамТаблицаСотрудников КАК ТаблицаСотрудников
        |
        |ИНДЕКСИРОВАТЬ ПО
        |   ФизЛицо";
		Запрос.УстановитьПараметр("парамТаблицаСотрудников", ОрганичениеНаСотрудников);
		Запрос.Выполнить();
	КонецЕсли;
	
	// Периоды
	// Таблица список периодов
	// Поля:
	//		Период
	// Описание:
	//  список периодов - первые даты месяцев с начала года по "текущий" для запроса период
	//
	
	// конец месяца налогового периода
	КонецМесяца = КонецМесяца(НачалоГода(ПериодРегистрации));
	// первый месяц
	ПериодыТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период ПОМЕСТИТЬ ВТПериоды";
	// прибавим остальные месяцы
	Для Сч = 2 По Месяц(ПериодРегистрации) Цикл
		КонецМесяца = КонецМесяца(КонецМесяца+1);
    	ПериодыТекст = ПериодыТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	Запрос.Текст = ПериодыТекст;
	Запрос.Выполнить();

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ЕСТЬNULL(УчетнаяПолитикаНалоговыйУчет.ВидТарифаСтраховыхВзносов, ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОбщийНалоговыйРежим)) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТИспользуемыеТарифы
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		МАКСИМУМ(УчетнаяПолитикаНалоговыйУчет.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|			ПО Периоды.Период >= УчетнаяПолитикаНалоговыйУчет.Период
	|				И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Период) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|		ПО Периоды.ПериодРегистра = УчетнаяПолитикаНалоговыйУчет.Период
	|			И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТарифСтраховыхВзносовСрезПоследних.ВидТарифа КАК ВидТарифа,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФР,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФРНакопительная,
	|	ТарифСтраховыхВзносовСрезПоследних.ФСС,
	|	ТарифСтраховыхВзносовСрезПоследних.ФФОМС,
	|	ТарифСтраховыхВзносовСрезПоследних.ТФОМС
	|ПОМЕСТИТЬ ВТТарифы
	|ИЗ
	|	РегистрСведений.ТарифСтраховыхВзносов.СрезПоследних(&парамКонецГода, ) КАК ТарифСтраховыхВзносовСрезПоследних
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидТарифа
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|	ЕСТЬNULL(ГражданствоФизЛиц.НеИмеетПравоНаПенсию, ЛОЖЬ) КАК НеИмеетПравоНаПенсию
	|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|			ПО Периоды.Период >= ГражданствоФизЛиц.Период
	|	ГДЕ
	|		ГражданствоФизЛиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ГражданствоФизЛиц.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|		ПО Периоды.ПериодРегистра = ГражданствоФизЛиц.Период
	|			И Периоды.Физлицо = ГражданствоФизЛиц.ФизЛицо
	|			И ГражданствоФизЛиц.НеИмеетПравоНаПенсию
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|	СведенияОбИнвалидностиФизлиц.Период КАК Период,
	|	СведенияОбИнвалидностиФизлиц.Инвалидность
	|ПОМЕСТИТЬ ВТ_СведенияОбИнвалидности
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|ГДЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТДанныеОбИнвалидности
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|		МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|			ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СведенияОбИнвалидностиФизлиц.Физлицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|		ПО (СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра)
	|			И Периоды.Физлицо = СведенияОбИнвалидностиФизлиц.Физлицо
	|			И (СведенияОбИнвалидностиФизлиц.Инвалидность)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуПФР КАК ВходитВБазуПФР,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФСС КАК ВходитВБазуФСС,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФОМС КАК ВходитВБазуФОМС,
	|	СведенияОДоходах.РезультатОборот - СведенияОДоходах.СкидкаОборот КАК ОблагаемыйДоход,
	|	СведенияОДоходах.ОблагаетсяЕНВД
	|ПОМЕСТИТЬ ВТДоходыПоФизлицамМесяцам
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах.Обороты(
	|			&парамНачалоГода,
	|			&парамКонецМесяцаПериодаРегистрации,
	|			Месяц,
	|			Организация = &парамГоловнаяОрганизация
	|				И Физлицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТСписокСотрудников КАК СписокСотрудников)) КАК СведенияОДоходах
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СтраховыеВзносыСведенияОДоходах.Период),
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	-СтраховыеВзносыСведенияОДоходах.Результат + СтраховыеВзносыСведенияОДоходах.Скидка,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СтраховыеВзносыСведенияОДоходах
	|ГДЕ
	|	СтраховыеВзносыСведенияОДоходах.Регистратор = &Регистратор
	|	И СтраховыеВзносыСведенияОДоходах.Организация = &парамГоловнаяОрганизация
	|	И СтраховыеВзносыСведенияОДоходах.ФизЛицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	СтраховыеВзносыСведенияОДоходах.Месяц,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаемыйДоход,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД
	|ИЗ
	|	ВТДанныеДокумента КАК СтраховыеВзносыСведенияОДоходах
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТФизлицаБезОблагаемойБазы
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК СведенияОДоходах
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫБОР
	|			КОГДА СведенияОДоходах.ВходитВБазуПФР
	|					ИЛИ СведенияОДоходах.ВходитВБазуФОМС
	|				ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) < 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|	СУММА(РанееИсчисленныеВзносы.ФССОборот) КАК ФССОборот,
	|	СУММА(РанееИсчисленныеВзносы.ФФОМСОборот) КАК ФФОМСОборот,
	|	СУММА(РанееИсчисленныеВзносы.ТФОМСОборот) КАК ТФОМСОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРНакопительнаяОборот) КАК ПФРНакопительнаяОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРСтраховаяОборот) КАК ПФРСтраховаяОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот) КАК ПФРПоДополнительномуТарифуОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот) КАК ПФРНаДоплатуКПенсииШахтерамОборот,
	|	СУММА(РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот) КАК ФССНесчастныеСлучаиОборот
	|ПОМЕСТИТЬ ВТРанееИсчисленныеВзносы
	|ИЗ
	|	(ВЫБРАТЬ
	|		РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|		МЕСЯЦ(РанееИсчисленныеВзносы.Период) КАК Месяц,
	|		РанееИсчисленныеВзносы.ФССОборот + РанееИсчисленныеВзносы.ФССЕНВДОборот КАК ФССОборот,
	|		РанееИсчисленныеВзносы.ФФОМСОборот + РанееИсчисленныеВзносы.ФФОМСЕНВДОборот КАК ФФОМСОборот,
	|		РанееИсчисленныеВзносы.ТФОМСОборот + РанееИсчисленныеВзносы.ТФОМСЕНВДОборот КАК ТФОМСОборот,
	|		РанееИсчисленныеВзносы.ПФРНакопительнаяОборот + РанееИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот КАК ПФРНакопительнаяОборот,
	|		РанееИсчисленныеВзносы.ПФРСтраховаяОборот + РанееИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот КАК ПФРСтраховаяОборот,
	|		РанееИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот КАК ПФРНаДоплатуКПенсииШахтерамОборот,
	|		РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот КАК ПФРПоДополнительномуТарифуОборот,
	|		ВЫБОР
	|			КОГДА РанееИсчисленныеВзносы.Период = &парамПериодРегистрации
	|				ТОГДА РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ФССНесчастныеСлучаиОборот
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыИсчисленные.Обороты(
	|				&парамНачалоГода,
	|				&парамКонецМесяцаПериодаРегистрации,
	|				Месяц,
	|				Организация = &парамГоловнаяОрганизация
	|					И (НЕ ФизЛицо В
	|							(ВЫБРАТЬ
	|								СписокСотрудников.ФизЛицо
	|							ИЗ
	|								ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|					И ФизЛицо В
	|						(ВЫБРАТЬ
	|							СписокСотрудников.ФизЛицо
	|						ИЗ
	|							ВТСписокСотрудников КАК СписокСотрудников)) КАК РанееИсчисленныеВзносы
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтраховыеВзносыИсчисленные.ФизЛицо,
	|		МЕСЯЦ(СтраховыеВзносыИсчисленные.Период),
	|		-СтраховыеВзносыИсчисленные.ФСС - СтраховыеВзносыИсчисленные.ФССЕНВД,
	|		-СтраховыеВзносыИсчисленные.ФФОМС - СтраховыеВзносыИсчисленные.ФФОМСЕНВД,
	|		-СтраховыеВзносыИсчисленные.ТФОМС - СтраховыеВзносыИсчисленные.ТФОМСЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРНакопительная - СтраховыеВзносыИсчисленные.ПФРНакопительнаяЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРСтраховая - СтраховыеВзносыИсчисленные.ПФРСтраховаяЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРНаДоплатуКПенсииШахтерам,
	|		-СтраховыеВзносыИсчисленные.ПФРПоДополнительномуТарифу,
	|		-СтраховыеВзносыИсчисленные.ФССНесчастныеСлучаи
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыИсчисленные КАК СтраховыеВзносыИсчисленные
	|	ГДЕ
	|		СтраховыеВзносыИсчисленные.Регистратор = &Регистратор
	|		И СтраховыеВзносыИсчисленные.Организация = &парамГоловнаяОрганизация
	|		И (НЕ СтраховыеВзносыИсчисленные.ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|		И СтраховыеВзносыИсчисленные.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)) КАК РанееИсчисленныеВзносы
	|
	|СГРУППИРОВАТЬ ПО
	|	РанееИсчисленныеВзносы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Основная.ФизЛицо КАК ФизЛицо,
	|	Основная.Месяц КАК Месяц,
	|	ВЫБОР
	|		КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ИЛИ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ЭтоИнвалидныйМесяц,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФР,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС,
	|	СУММА(ВЫБОР
	|			КОГДА (Иностр.Физлицо ЕСТЬ NULL 
	|					ИЛИ (НЕ Иностр.НеИмеетПравоНаПенсию))
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА (Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					ИЛИ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|					И Основная.ВходитВБазуФСС
	|					И &парамЭтоЮрЛицо
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС_НСИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И &парамЭтоЮрЛицо
	|				ТОГДА 0
	|			КОГДА ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|				ТОГДА 0
	|			КОГДА Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС_НСПоОсновномуТарифу,
	|	ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТДоходыЗастрахованныхЛиц
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК Основная
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОПравеНаПенсию КАК Иностр
	|		ПО Основная.ФизЛицо = Иностр.Физлицо
	|			И Основная.Месяц = Иностр.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|		ПО Основная.ФизЛицо = Инвалид.Физлицо
	|			И Основная.Месяц = Инвалид.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИспользуемыеТарифы КАК ИспользуемыеТарифы
	|		ПО Основная.Месяц = ИспользуемыеТарифы.Месяц
	|ГДЕ
	|	(НЕ Основная.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	Основная.ФизЛицо,
	|	Основная.Месяц,
	|	ВЫБОР
	|		КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				ИЛИ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ,
	|	ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ДоходыЗастрахованныхЛиц.ФизЛицо КАК ФизЛицо,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаПФР) КАК БазаПФР,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФСС) КАК БазаФСС,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФОМС) КАК БазаФОМС
	|ПОМЕСТИТЬ ВТНакопленнаяОблагаемаяБаза
	|ИЗ
	|	ВТПериоды КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|		ПО (ДоходыЗастрахованныхЛиц.Месяц МЕЖДУ 1 И МЕСЯЦ(Периоды.Период))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыЗастрахованныхЛиц.ФизЛицо,
	|	МЕСЯЦ(Периоды.Период)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	База.Месяц КАК Месяц,
	|	База.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА База.БазаПФР <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаПФР = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0)
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0)) / (База.БазаПФР - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаПФР, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияПФР,
	|	ВЫБОР
	|		КОГДА База.БазаФСС <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаФСС = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0)
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0)) / (База.БазаФСС - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФСС, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияФСС,
	|	ВЫБОР
	|		КОГДА База.БазаФОМС <= &ПредельнаяСумма
	|			ТОГДА 1
	|		КОГДА База.БазаФОМС = ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0)
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0) >= &ПредельнаяСумма
	|			ТОГДА 0
	|		ИНАЧЕ (&ПредельнаяСумма - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0)) / (База.БазаФОМС - ЕСТЬNULL(НакопленоПоПрошлыйМесяц.БазаФОМС, 0))
	|	КОНЕЦ КАК КоэффициентОбложенияФОМС
	|ПОМЕСТИТЬ ВТКоэффициентыДостиженияПредельнойСуммы
	|ИЗ
	|	ВТНакопленнаяОблагаемаяБаза КАК База
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленнаяОблагаемаяБаза КАК НакопленоПоПрошлыйМесяц
	|		ПО (База.Месяц - 1 = НакопленоПоПрошлыйМесяц.Месяц)
	|			И База.ФизЛицо = НакопленоПоПрошлыйМесяц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыЗастрахованныхЛиц.ФизЛицо КАК ФизЛицо,
	|	ДоходыЗастрахованныхЛиц.Месяц КАК Месяц,
	|	ДоходыЗастрахованныхЛиц.ВидТарифаСтраховыхВзносов,
	|	ВЫБОР
	|		КОГДА (НЕ ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц)
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаПФР - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФР = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|	КОНЕЦ КАК БазаПФРИнвалида,
	|	ВЫБОР
	|		КОГДА ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаПФР - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияПФР = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаПФР = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаПФР, 0)
	|	КОНЕЦ КАК БазаПФРПоОсновномуТарифу,
	|	ВЫБОР
	|		КОГДА (НЕ ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц)
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаФСС - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФСС = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|	КОНЕЦ КАК БазаФССИнвалида,
	|	ВЫБОР
	|		КОГДА ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаФСС - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияФСС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФСС = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФСС, 0)
	|	КОНЕЦ КАК БазаФССПоОсновномуТарифу,
	|	ВЫБОР
	|		КОГДА (НЕ ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц)
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаФОМС - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМС = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|	КОНЕЦ КАК БазаФОМСИнвалида,
	|	ВЫБОР
	|		КОГДА ДоходыЗастрахованныхЛиц.ЭтоИнвалидныйМесяц
	|			ТОГДА 0
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 1
	|			ТОГДА НакопленнаяОблагаемаяБазаТекущийМесяц.БазаФОМС - ВЫБОР
	|					КОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0) < &ПредельнаяСумма
	|						ТОГДА ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|					ИНАЧЕ &ПредельнаяСумма
	|				КОНЕЦ
	|		КОГДА Коэффициенты.КоэффициентОбложенияФОМС = 0
	|			ТОГДА 0
	|		КОГДА ДоходыЗастрахованныхЛиц.БазаФОМС = 0
	|			ТОГДА 0
	|		ИНАЧЕ &ПредельнаяСумма - ЕСТЬNULL(НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.БазаФОМС, 0)
	|	КОНЕЦ КАК БазаФОМСПоОсновномуТарифу
	|ПОМЕСТИТЬ ВТОграниченнаяОблагаемаяБаза
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТКоэффициентыДостиженияПредельнойСуммы КАК Коэффициенты
	|		ПО ДоходыЗастрахованныхЛиц.ФизЛицо = Коэффициенты.ФизЛицо
	|			И ДоходыЗастрахованныхЛиц.Месяц = Коэффициенты.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленнаяОблагаемаяБаза КАК НакопленнаяОблагаемаяБазаПоПредыдущийМесяц
	|		ПО ДоходыЗастрахованныхЛиц.ФизЛицо = НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.ФизЛицо
	|			И (ДоходыЗастрахованныхЛиц.Месяц - 1 = НакопленнаяОблагаемаяБазаПоПредыдущийМесяц.Месяц)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленнаяОблагаемаяБаза КАК НакопленнаяОблагаемаяБазаТекущийМесяц
	|		ПО ДоходыЗастрахованныхЛиц.ФизЛицо = НакопленнаяОблагаемаяБазаТекущийМесяц.ФизЛицо
	|			И ДоходыЗастрахованныхЛиц.Месяц = НакопленнаяОблагаемаяБазаТекущийМесяц.Месяц
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * ОсновнойТариф.ПФРНакопительная / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРНакопительная,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * ОсновнойТариф.ПФР / 100 КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРПоОсновномуТарифу) * (ОсновнойТариф.ПФР - ОсновнойТариф.ПФРНакопительная) / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРСтраховая,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФССПоОсновномуТарифу) * ОсновнойТариф.ФСС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФСС,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСПоОсновномуТарифу) * ОсновнойТариф.ФФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФФОМС,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСПоОсновномуТарифу) * ОсновнойТариф.ТФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатТФОМС
	|ПОМЕСТИТЬ ВТИсчисленоПоОсновномуТарифу
	|ИЗ
	|	ВТОграниченнаяОблагаемаяБаза КАК ОграниченнаяОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ОсновнойТариф
	|		ПО ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ОсновнойТариф.ВидТарифа
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновнойТариф.ПФРНакопительная,
	|	ОсновнойТариф.ПФР,
	|	ОсновнойТариф.ФСС,
	|	ОсновнойТариф.ФФОМС,
	|	ОсновнойТариф.ТФОМС,
	|	ОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * ТарифИнвалида.ПФРНакопительная / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРНакопительнаяИнвалида,
	|	ВЫБОР
	|		КОГДА ГОД(ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * ТарифИнвалида.ПФР / 100 КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаПФРИнвалида) * (ТарифИнвалида.ПФР - ТарифИнвалида.ПФРНакопительная) / 100 КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК РезультатПФРСтраховаяИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФССИнвалида) * ТарифИнвалида.ФСС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФССИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСИнвалида) * ТарифИнвалида.ФФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФФОМСИнвалида,
	|	ВЫРАЗИТЬ(СУММА(ОграниченнаяОблагаемаяБаза.БазаФОМСИнвалида) * ТарифИнвалида.ТФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатТФОМСИнвалида
	|ПОМЕСТИТЬ ВТИсчисленоПоЛьготномуТарифу
	|ИЗ
	|	ВТОграниченнаяОблагаемаяБаза КАК ОграниченнаяОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ТарифИнвалида
	|		ПО (ТарифИнвалида.ВидТарифа = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|
	|СГРУППИРОВАТЬ ПО
	|	ТарифИнвалида.ПФРНакопительная,
	|	ТарифИнвалида.ПФР,
	|	ТарифИнвалида.ФСС,
	|	ТарифИнвалида.ФФОМС,
	|	ТарифИнвалида.ТФОМС,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо,
	|	ОграниченнаяОблагаемаяБаза.ФизЛицо.ДатаРождения
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(ДоходыФизлиц.ОблагаемыйДоход) * 0.14 КАК ЧИСЛО(15, 2)) КАК РезультатПоДополнительномуТарифу,
	|	ДоходыФизлиц.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТВзносыПоДополнительномуТарифу
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК ДоходыФизлиц
	|ГДЕ
	|	ДоходыФизлиц.ОблагаетсяПоДополнительномуТарифу
	|	И ДоходыФизлиц.ВходитВБазуПФР
	|	И (НЕ ДоходыФизлиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(ДоходыФизлиц.ОблагаемыйДоход) * 0.067 КАК ЧИСЛО(15, 2)) КАК РезультатПоДополнительномуТарифу,
	|	ДоходыФизлиц.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТВзносыДляШахтеров
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК ДоходыФизлиц
	|ГДЕ
	|	ДоходыФизлиц.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам
	|	И ДоходыФизлиц.ВходитВБазуПФР
	|	И (НЕ ДоходыФизлиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Начислено.ФизЛицо КАК ФизЛицо,
	|	(ВЫРАЗИТЬ(Начислено.БазаФСС_НСПоОсновномуТарифу * &СтавкаВзносаФСС_НС_ПЗ КАК ЧИСЛО(15, 2))) + (ВЫРАЗИТЬ(Начислено.БазаФСС_НСИнвалида * &СтавкаВзносаФСС_НС_ПЗ * 0.6 КАК ЧИСЛО(15, 2))) - ЕСТЬNULL(РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот, 0) КАК Взносов
	|ПОМЕСТИТЬ ВТВзносыФССНесчастныеСлучаи
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК Начислено
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРанееИсчисленныеВзносы КАК РанееИсчисленныеВзносы
	|		ПО Начислено.ФизЛицо = РанееИсчисленныеВзносы.ФизЛицо
	|ГДЕ
	|	Начислено.Месяц = &парамМесяцРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВсегоИсчислено.ФизЛицо КАК ФизЛицо,
	|	ВсегоИсчислено.Порядок,
	|	СУММА(ВсегоИсчислено.РезультатПФРНакопительная) КАК РезультатПФРНакопительная,
	|	СУММА(ВсегоИсчислено.РезультатПФРСтраховая) КАК РезультатПФРСтраховая,
	|	СУММА(ВсегоИсчислено.РезультатФСС) КАК РезультатФСС,
	|	СУММА(ВсегоИсчислено.РезультатФФОМС) КАК РезультатФФОМС,
	|	СУММА(ВсегоИсчислено.РезультатТФОМС) КАК РезультатТФОМС,
	|	СУММА(ВсегоИсчислено.РезультатПоДополнительномуТарифу) КАК РезультатПоДополнительномуТарифу,
	|	СУММА(ВсегоИсчислено.РезультатФССНесчастныеСлучаи) КАК РезультатФССНесчастныеСлучаи,
	|	СУММА(ВсегоИсчислено.РезультатДляШахтеров) КАК РезультатДляШахтеров
	|ПОМЕСТИТЬ ВТСуммыВзносовНарастающимИтогом
	|ИЗ
	|	(ВЫБРАТЬ
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо КАК ФизЛицо,
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо.Наименование КАК Порядок,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРНакопительная КАК РезультатПФРНакопительная,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРСтраховая КАК РезультатПФРСтраховая,
	|		ИсчисленоПоОсновномуТарифу.РезультатФСС КАК РезультатФСС,
	|		ИсчисленоПоОсновномуТарифу.РезультатФФОМС КАК РезультатФФОМС,
	|		ИсчисленоПоОсновномуТарифу.РезультатТФОМС КАК РезультатТФОМС,
	|		0 КАК РезультатПоДополнительномуТарифу,
	|		0 КАК РезультатФССНесчастныеСлучаи,
	|		0 КАК РезультатДляШахтеров
	|	ИЗ
	|		ВТИсчисленоПоОсновномуТарифу КАК ИсчисленоПоОсновномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ИсчисленоПоЛьготномуТарифу.ФизЛицо,
	|		ИсчисленоПоЛьготномуТарифу.ФизЛицо.Наименование,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРНакопительнаяИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатПФРСтраховаяИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатФССИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатФФОМСИнвалида,
	|		ИсчисленоПоЛьготномуТарифу.РезультатТФОМСИнвалида,
	|		0,
	|		0,
	|		0
	|	ИЗ
	|		ВТИсчисленоПоЛьготномуТарифу КАК ИсчисленоПоЛьготномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыПоДополнительномуТарифу.ФизЛицо,
	|		ВзносыПоДополнительномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыПоДополнительномуТарифу.РезультатПоДополнительномуТарифу,
	|		0,
	|		0
	|	ИЗ
	|		ВТВзносыПоДополнительномуТарифу КАК ВзносыПоДополнительномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыПоДополнительномуТарифу.ФизЛицо,
	|		ВзносыПоДополнительномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыПоДополнительномуТарифу.РезультатПоДополнительномуТарифу
	|	ИЗ
	|		ВТВзносыДляШахтеров КАК ВзносыПоДополнительномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыФС_НС_ПЗ.ФизЛицо,
	|		ВзносыФС_НС_ПЗ.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыФС_НС_ПЗ.Взносов,
	|		0
	|	ИЗ
	|		ВТВзносыФССНесчастныеСлучаи КАК ВзносыФС_НС_ПЗ) КАК ВсегоИсчислено
	|
	|СГРУППИРОВАТЬ ПО
	|	ВсегоИсчислено.ФизЛицо,
	|	ВсегоИсчислено.Порядок
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СуммыНарастающимИтогом.ФизЛицо КАК ФизЛицо,
	|	СуммыНарастающимИтогом.Порядок КАК Порядок,
	|	СуммыНарастающимИтогом.РезультатФСС - ЕСТЬNULL(ИсчисленныеВзносы.ФССОборот, 0) КАК ФСС,
	|	СуммыНарастающимИтогом.РезультатФФОМС - ЕСТЬNULL(ИсчисленныеВзносы.ФФОМСОборот, 0) КАК ФФОМС,
	|	СуммыНарастающимИтогом.РезультатТФОМС - ЕСТЬNULL(ИсчисленныеВзносы.ТФОМСОборот, 0) КАК ТФОМС,
	|	СуммыНарастающимИтогом.РезультатПФРНакопительная - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборот, 0) КАК ПФРНакопительная,
	|	СуммыНарастающимИтогом.РезультатПФРСтраховая - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборот, 0) КАК ПФРСтраховая,
	|	СуммыНарастающимИтогом.РезультатПоДополнительномуТарифу - ЕСТЬNULL(ИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот, 0) КАК ПФРПоДополнительномуТарифу,
	|	СуммыНарастающимИтогом.РезультатФССНесчастныеСлучаи КАК ФССНесчастныеСлучаи,
	|	СуммыНарастающимИтогом.РезультатДляШахтеров - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот, 0) КАК ПФРНаДоплатуКПенсииШахтерам
	|ПОМЕСТИТЬ ВТВзносыЗаМесяц
	|ИЗ
	|	ВТСуммыВзносовНарастающимИтогом КАК СуммыНарастающимИтогом
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРанееИсчисленныеВзносы КАК ИсчисленныеВзносы
	|		ПО СуммыНарастающимИтогом.ФизЛицо = ИсчисленныеВзносы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Порядок
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Основная.ФизЛицо КАК ФизЛицо,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФР,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФССЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМСЕНВД
	|ПОМЕСТИТЬ ВТРаспределениеДоходовПоЕНВД
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК Основная
	|ГДЕ
	|	(НЕ Основная.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|	И Основная.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	Основная.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА СУММА(ВЫБОР
	|						КОГДА СведенияОДоходах.ОблагаетсяЕНВД
	|							ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|						ИНАЧЕ 0
	|					КОНЕЦ) > 0
	|				И СУММА(ВЫБОР
	|						КОГДА (НЕ СведенияОДоходах.ОблагаетсяЕНВД)
	|							ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|						ИНАЧЕ 0
	|					КОНЕЦ) = 0
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ТолькоЕНВД,
	|	СведенияОДоходах.ФизЛицо
	|ПОМЕСТИТЬ ВТВидыДеятельности
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК СведенияОДоходах
	|ГДЕ
	|	СведенияОДоходах.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Взносы.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ФФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ФФОМС - (ВЫРАЗИТЬ(Взносы.ФФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ФФОМС,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ФФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ФФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ФФОМСЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ТФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ТФОМС - (ВЫРАЗИТЬ(Взносы.ТФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ТФОМС,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ТФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ТФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ТФОМСЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ФСС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ФСС - (ВЫРАЗИТЬ(Взносы.ФСС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ФСС,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ФСС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ФСС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ФССЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ПФРНакопительная
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ПФРНакопительная - (ВЫРАЗИТЬ(Взносы.ПФРНакопительная * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ПФРНакопительная,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ПФРНакопительная
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ПФРНакопительная * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ПФРНакопительнаяЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ПФРСтраховая
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ПФРСтраховая - (ВЫРАЗИТЬ(Взносы.ПФРСтраховая * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ПФРСтраховая,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ПФРСтраховая
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ПФРСтраховая * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ПФРСтраховаяЕНВД,
	|	Взносы.ПФРПоДополнительномуТарифу,
	|	Взносы.ФССНесчастныеСлучаи,
	|	Взносы.ПФРНаДоплатуКПенсииШахтерам
	|ИЗ
	|	ВТВзносыЗаМесяц КАК Взносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРаспределениеДоходовПоЕНВД КАК РаспределениеДоходовПоЕНВД
	|		ПО Взносы.ФизЛицо = РаспределениеДоходовПоЕНВД.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТВидыДеятельности КАК ВидыДеятельности
	|		ПО Взносы.ФизЛицо = ВидыДеятельности.ФизЛицо
	|ГДЕ
	|	(Взносы.ФСС <> 0
	|			ИЛИ Взносы.ФФОМС <> 0
	|			ИЛИ Взносы.ТФОМС <> 0
	|			ИЛИ Взносы.ПФРНакопительная <> 0
	|			ИЛИ Взносы.ПФРСтраховая <> 0
	|			ИЛИ Взносы.ПФРПоДополнительномуТарифу <> 0
	|			ИЛИ Взносы.ПФРНаДоплатуКПенсииШахтерам <> 0
	|			ИЛИ Взносы.ФССНесчастныеСлучаи <> 0)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Взносы.Порядок";
	
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"РегистрСведений.УчетнаяПолитикаНалоговыйУчет", ЗаполнениеРегламентированнойОтчетностиПереопределяемый.ИмяУчетнойПолитики());
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции  // ПолучитьДанныеРасчета

// Предназначена для получения выборки из запроса с данными расчета 
// По текущему регистратору получает 
//    	данные о начисленной зарплате в разрезе кодов дохода 
// 		данные об инвалидности физлиц помесячно
//		присоединяет данные о скидках к доходам
//
// Параметры:
//  нет
// Возвращаемое значение:
//  Выборка результата запроса
//
Функция ПолучитьДанныеРасчета(ГоловнаяОрганизация, ОрганичениеНаСотрудников, ДанныеОДоходах, Отказ)
	
	Если Отказ Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	// расчет вызван независимо от получения данных о доходах,
	// получим список сотрудников для расчета 
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		ОрганичениеНаСотрудников = ПолучитьОграничениеНаСотрудников(Отказ);	
		Если Отказ Тогда
			Возврат Неопределено;
		КонецЕсли;
	КонецЕсли;
	
	Запрос = Новый Запрос();
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГодРасчета", Год(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамМесяцРасчета", Месяц(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПредыдущийМесяц", Месяц(ПериодРегистрации) - 1);
	Запрос.УстановитьПараметр("парамПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамЭтоЮрЛицо", ОбщегоНазначенияПереопределяемый.ЭтоЮрЛицо(Организация));
	Запрос.УстановитьПараметр("Регистратор", Ссылка);
	ПредельнаяСумма = РегистрыСведений.ПредельнаяВеличинаБазыСтраховыхВзносов.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации)).Размер;
	Запрос.УстановитьПараметр("ПредельнаяСумма", ?(ЗначениеЗаполнено(ПредельнаяСумма),ПредельнаяСумма,0));
	Ставка = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации), Новый Структура("Организация", Организация)).Ставка;
	Запрос.УстановитьПараметр("СтавкаВзносаФСС_НС_ПЗ", Ставка / 100);
	
	// ---------------------------------------------------------------------------
	// тексты запросов
	//

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
	|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
	|	СведенияОДоходах.ВидДохода,
	|	СведенияОДоходах.Результат - СведенияОДоходах.Скидка КАК ОблагаемыйДоход,
	|	СведенияОДоходах.ОблагаетсяЕНВД
	|ПОМЕСТИТЬ ВТДанныеДокумента
	|ИЗ
	|	&ДанныеОДоходах КАК СведенияОДоходах";
	Запрос.УстановитьПараметр("ДанныеОДоходах", ДанныеОДоходах);
	Запрос.Выполнить();
	
	// ФизлицаДляРасчета
	//
	Если ОрганичениеНаСотрудников = Неопределено Тогда
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
		|ПОМЕСТИТЬ ВТСписокСотрудников
		|ИЗ
		|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &парамПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СведенияОДоходах.ФизЛицо
		|ИЗ
		|	ВТДанныеДокумента КАК СведенияОДоходах
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо";
		Запрос.Выполнить();
		
	Иначе
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
        |   ТаблицаСотрудников.ФизЛицо КАК ФизЛицо
        |ПОМЕСТИТЬ ВТСписокСотрудников
        |ИЗ
        |   &парамТаблицаСотрудников КАК ТаблицаСотрудников
        |
        |ИНДЕКСИРОВАТЬ ПО
        |   ФизЛицо";
		Запрос.УстановитьПараметр("парамТаблицаСотрудников", ОрганичениеНаСотрудников);
		Запрос.Выполнить();
	КонецЕсли;
	
	// Периоды
	// Таблица список периодов
	// Поля:
	//		Период
	// Описание:
	//  список периодов - первые даты месяцев с начала года по "текущий" для запроса период
	//
	
	// конец месяца налогового периода
	КонецМесяца = КонецМесяца(НачалоГода(ПериодРегистрации));
	// первый месяц
	ПериодыТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период ПОМЕСТИТЬ ВТПериоды";
	// прибавим остальные месяцы
	Для Сч = 2 По Месяц(ПериодРегистрации) Цикл
		КонецМесяца = КонецМесяца(КонецМесяца+1);
    	ПериодыТекст = ПериодыТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	Запрос.Текст = ПериодыТекст;
	Запрос.Выполнить();

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	ЕСТЬNULL(УчетнаяПолитикаНалоговыйУчет.ВидТарифаСтраховыхВзносов, ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОбщийНалоговыйРежим)) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТИспользуемыеТарифы
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		МАКСИМУМ(УчетнаяПолитикаНалоговыйУчет.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|			ПО Периоды.Период >= УчетнаяПолитикаНалоговыйУчет.Период
	|				И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Период) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет КАК УчетнаяПолитикаНалоговыйУчет
	|		ПО Периоды.ПериодРегистра = УчетнаяПолитикаНалоговыйУчет.Период
	|			И (УчетнаяПолитикаНалоговыйУчет.Организация = &парамГоловнаяОрганизация)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТарифСтраховыхВзносовСрезПоследних.ВидТарифа КАК ВидТарифа,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФР,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФРНакопительная,
	|	ТарифСтраховыхВзносовСрезПоследних.ФСС,
	|	ТарифСтраховыхВзносовСрезПоследних.ФФОМС,
	|	ТарифСтраховыхВзносовСрезПоследних.ТФОМС,
	|	ТарифСтраховыхВзносовСрезПоследних.ПФР + ТарифСтраховыхВзносовСрезПоследних.ФСС + ТарифСтраховыхВзносовСрезПоследних.ФФОМС + ТарифСтраховыхВзносовСрезПоследних.ТФОМС КАК СуммарныйТариф
	|ПОМЕСТИТЬ ВТТарифы
	|ИЗ
	|	РегистрСведений.ТарифСтраховыхВзносов.СрезПоследних(&парамКонецГода, ) КАК ТарифСтраховыхВзносовСрезПоследних
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидТарифа
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Тарифы.ВидТарифа,
	|	ВЫБОР
	|		КОГДА Тарифы.СуммарныйТариф > ТарифДляИнвалидов.СуммарныйТариф
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ВыделятьДоходыИнвалидов
	|ПОМЕСТИТЬ ВТОписаниеТарифов
	|ИЗ
	|	ВТТарифы КАК Тарифы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ТарифДляИнвалидов
	|		ПО (ТарифДляИнвалидов.ВидТарифа = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	Периоды.Физлицо КАК Физлицо,
	|	(НЕ ЕСТЬNULL(ГражданствоФизЛиц.НеИмеетПравоНаПенсию, ЛОЖЬ)) КАК ИмеетПравоНаСтрахование,
	|	ЕСТЬNULL(ГражданствоФизЛиц.ВидЗастрахованногоЛица, ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ГражданеРФ)) КАК ВидЗастрахованногоЛица
	|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		СписокСотрудников.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСписокСотрудников КАК СписокСотрудников
	|			ПО (ИСТИНА)
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|			ПО Периоды.Период >= ГражданствоФизЛиц.Период
	|				И (СписокСотрудников.ФизЛицо = ГражданствоФизЛиц.ФизЛицо)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СписокСотрудников.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|		ПО Периоды.ПериодРегистра = ГражданствоФизЛиц.Период
	|			И Периоды.Физлицо = ГражданствоФизЛиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	Периоды.Физлицо КАК Физлицо,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА ВременноПребывающие.ПериодЗавершения < НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ)
	|					И ВременноПребывающие.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА (НЕ ВременноПребывающие.ПринятПоДолгосрочномуДоговору)
	|			ИНАЧЕ ВременноПребывающие.ПринятПоДолгосрочномуДоговору
	|		КОНЕЦ, ЛОЖЬ) КАК ЕстьДолгосрочныйДоговор
	|ПОМЕСТИТЬ ВТПринятыеПоДолгосрочнымДоговорам
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		СписокСотрудников.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ВременноПребывающие.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСписокСотрудников КАК СписокСотрудников
	|			ПО (ИСТИНА)
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВременноПребывающиеПринятыеПоДолгосрочнымДоговорам КАК ВременноПребывающие
	|			ПО Периоды.Период >= ВременноПребывающие.Период
	|				И (СписокСотрудников.ФизЛицо = ВременноПребывающие.ФизЛицо)
	|				И (ВременноПребывающие.Организация = &парамГоловнаяОрганизация)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СписокСотрудников.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВременноПребывающиеПринятыеПоДолгосрочнымДоговорам КАК ВременноПребывающие
	|		ПО Периоды.ПериодРегистра = ВременноПребывающие.Период
	|			И Периоды.Физлицо = ВременноПребывающие.ФизЛицо
	|			И (ВременноПребывающие.Организация = &парамГоловнаяОрганизация)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|	СведенияОбИнвалидностиФизлиц.Период КАК Период,
	|	СведенияОбИнвалидностиФизлиц.Инвалидность
	|ПОМЕСТИТЬ ВТ_СведенияОбИнвалидности
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|ГДЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МЕСЯЦ(Периоды.Период) КАК Месяц,
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТДанныеОбИнвалидности
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|		МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|			ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СведенияОбИнвалидностиФизлиц.Физлицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбИнвалидности КАК СведенияОбИнвалидностиФизлиц
	|		ПО (СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра)
	|			И Периоды.Физлицо = СведенияОбИнвалидностиФизлиц.Физлицо
	|			И (СведенияОбИнвалидностиФизлиц.Инвалидность)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	МЕСЯЦ(СведенияОДоходах.Период) КАК Месяц,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуПФР КАК ВходитВБазуПФР,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФСС КАК ВходитВБазуФСС,
	|	СведенияОДоходах.ВидДохода.ВходитВБазуФОМС КАК ВходитВБазуФОМС,
	|	СведенияОДоходах.РезультатОборот - СведенияОДоходах.СкидкаОборот КАК ОблагаемыйДоход,
	|	СведенияОДоходах.ОблагаетсяЕНВД,
	|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
	|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|ПОМЕСТИТЬ ВТДоходыПоФизлицамМесяцам
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах.Обороты(
	|			&парамНачалоГода,
	|			&парамКонецМесяцаПериодаРегистрации,
	|			Месяц,
	|			Организация = &парамГоловнаяОрганизация
	|				И Физлицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТСписокСотрудников КАК СписокСотрудников)) КАК СведенияОДоходах
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	МЕСЯЦ(СтраховыеВзносыСведенияОДоходах.Период),
	|	СтраховыеВзносыСведенияОДоходах.Период,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	-СтраховыеВзносыСведенияОДоходах.Результат + СтраховыеВзносыСведенияОДоходах.Скидка,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
	|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомФармацевта,
	|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|ИЗ
	|	РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СтраховыеВзносыСведенияОДоходах
	|ГДЕ
	|	СтраховыеВзносыСведенияОДоходах.Регистратор = &Регистратор
	|	И СтраховыеВзносыСведенияОДоходах.Организация = &парамГоловнаяОрганизация
	|	И СтраховыеВзносыСведенияОДоходах.ФизЛицо В
	|			(ВЫБРАТЬ
	|				СписокСотрудников.ФизЛицо
	|			ИЗ
	|				ВТСписокСотрудников КАК СписокСотрудников)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|	СтраховыеВзносыСведенияОДоходах.Месяц,
	|	СтраховыеВзносыСведенияОДоходах.Период,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуПФР,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФСС,
	|	СтраховыеВзносыСведенияОДоходах.ВидДохода.ВходитВБазуФОМС,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаемыйДоход,
	|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
	|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомФармацевта,
	|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|ИЗ
	|	ВТДанныеДокумента КАК СтраховыеВзносыСведенияОДоходах
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Месяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТФизлицаБезОблагаемойБазы
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК СведенияОДоходах
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВЫБОР
	|			КОГДА СведенияОДоходах.ВходитВБазуПФР
	|					ИЛИ СведенияОДоходах.ВходитВБазуФОМС
	|				ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) < 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|	СУММА(РанееИсчисленныеВзносы.ФССОборот) КАК ФССОборот,
	|	СУММА(РанееИсчисленныеВзносы.ФФОМСОборот) КАК ФФОМСОборот,
	|	СУММА(РанееИсчисленныеВзносы.ТФОМСОборот) КАК ТФОМСОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРНакопительнаяОборот) КАК ПФРНакопительнаяОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРСтраховаяОборот) КАК ПФРСтраховаяОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот) КАК ПФРПоДополнительномуТарифуОборот,
	|	СУММА(РанееИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот) КАК ПФРНаДоплатуКПенсииШахтерамОборот,
	|	СУММА(РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот) КАК ФССНесчастныеСлучаиОборот
	|ПОМЕСТИТЬ ВТРанееИсчисленныеВзносы
	|ИЗ
	|	(ВЫБРАТЬ
	|		РанееИсчисленныеВзносы.ФизЛицо КАК ФизЛицо,
	|		МЕСЯЦ(РанееИсчисленныеВзносы.Период) КАК Месяц,
	|		РанееИсчисленныеВзносы.ФССОборот + РанееИсчисленныеВзносы.ФССЕНВДОборот КАК ФССОборот,
	|		РанееИсчисленныеВзносы.ФФОМСОборот + РанееИсчисленныеВзносы.ФФОМСЕНВДОборот КАК ФФОМСОборот,
	|		РанееИсчисленныеВзносы.ТФОМСОборот + РанееИсчисленныеВзносы.ТФОМСЕНВДОборот КАК ТФОМСОборот,
	|		РанееИсчисленныеВзносы.ПФРНакопительнаяОборот + РанееИсчисленныеВзносы.ПФРНакопительнаяЕНВДОборот КАК ПФРНакопительнаяОборот,
	|		РанееИсчисленныеВзносы.ПФРСтраховаяОборот + РанееИсчисленныеВзносы.ПФРСтраховаяЕНВДОборот КАК ПФРСтраховаяОборот,
	|		РанееИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот КАК ПФРНаДоплатуКПенсииШахтерамОборот,
	|		РанееИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот КАК ПФРПоДополнительномуТарифуОборот,
	|		ВЫБОР
	|			КОГДА РанееИсчисленныеВзносы.Период = &парамПериодРегистрации
	|				ТОГДА РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ФССНесчастныеСлучаиОборот
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыИсчисленные.Обороты(
	|				&парамНачалоГода,
	|				&парамКонецМесяцаПериодаРегистрации,
	|				Месяц,
	|				Организация = &парамГоловнаяОрганизация
	|					И (НЕ ФизЛицо В
	|							(ВЫБРАТЬ
	|								СписокСотрудников.ФизЛицо
	|							ИЗ
	|								ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|					И ФизЛицо В
	|						(ВЫБРАТЬ
	|							СписокСотрудников.ФизЛицо
	|						ИЗ
	|							ВТСписокСотрудников КАК СписокСотрудников)) КАК РанееИсчисленныеВзносы
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтраховыеВзносыИсчисленные.ФизЛицо,
	|		МЕСЯЦ(СтраховыеВзносыИсчисленные.Период),
	|		-СтраховыеВзносыИсчисленные.ФСС - СтраховыеВзносыИсчисленные.ФССЕНВД,
	|		-СтраховыеВзносыИсчисленные.ФФОМС - СтраховыеВзносыИсчисленные.ФФОМСЕНВД,
	|		-СтраховыеВзносыИсчисленные.ТФОМС - СтраховыеВзносыИсчисленные.ТФОМСЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРНакопительная - СтраховыеВзносыИсчисленные.ПФРНакопительнаяЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРСтраховая - СтраховыеВзносыИсчисленные.ПФРСтраховаяЕНВД,
	|		-СтраховыеВзносыИсчисленные.ПФРНаДоплатуКПенсииШахтерам,
	|		-СтраховыеВзносыИсчисленные.ПФРПоДополнительномуТарифу,
	|		-СтраховыеВзносыИсчисленные.ФССНесчастныеСлучаи
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыИсчисленные КАК СтраховыеВзносыИсчисленные
	|	ГДЕ
	|		СтраховыеВзносыИсчисленные.Регистратор = &Регистратор
	|		И СтраховыеВзносыИсчисленные.Организация = &парамГоловнаяОрганизация
	|		И (НЕ СтраховыеВзносыИсчисленные.ФизЛицо В
	|					(ВЫБРАТЬ
	|						СписокСотрудников.ФизЛицо
	|					ИЗ
	|						ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|		И СтраховыеВзносыИсчисленные.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТСписокСотрудников КАК СписокСотрудников)) КАК РанееИсчисленныеВзносы
	|
	|СГРУППИРОВАТЬ ПО
	|	РанееИсчисленныеВзносы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Основная.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА ГОД(Основная.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ЛОЖЬ
	|		КОГДА Иностр.ВидЗастрахованногоЛица = ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ВременноПребывающиеИностранцы)
	|			ТОГДА ЛОЖЬ
	|		КОГДА Иностр.ВидЗастрахованногоЛица = ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ВременноПроживающиеИностранцы)
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК НачислятьНакопительнуюЧасть,
	|	Основная.Месяц КАК Месяц,
	|	Основная.Период,
	|	ВЫБОР
	|		КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				И ОписаниеТарифов.ВыделятьДоходыИнвалидов
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|		КОГДА Основная.ЯвляетсяДоходомФармацевта
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляФармацевтовАптек)
	|		КОГДА Основная.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляЧленовЭкипажейМорскихСудовПодФлагомРФ)
	|		ИНАЧЕ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов
	|	КОНЕЦ КАК ВидТарифаСтраховыхВзносов,
	|	СУММА(ВЫБОР
	|			КОГДА Иностр.ИмеетПравоНаСтрахование
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			КОГДА Иностр.ВидЗастрахованногоЛица = ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ВременноПребывающиеИностранцы)
	|					И ПринятыеПоДолгосрочнымДоговорам.ЕстьДолгосрочныйДоговор
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФР,
	|	СУММА(ВЫБОР
	|			КОГДА Иностр.ИмеетПравоНаСтрахование
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС,
	|	СУММА(ВЫБОР
	|			КОГДА Иностр.ИмеетПравоНаСтрахование
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА (Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					ИЛИ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов))
	|					И Основная.ВходитВБазуФСС
	|					И &парамЭтоЮрЛицо
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС_НСИнвалида,
	|	СУММА(ВЫБОР
	|			КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|					И &парамЭтоЮрЛицо
	|				ТОГДА 0
	|			КОГДА ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|				ТОГДА 0
	|			КОГДА Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС_НСПоОсновномуТарифу
	|ПОМЕСТИТЬ ВТДоходыЗастрахованныхЛиц
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК Основная
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОПравеНаПенсию КАК Иностр
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТПринятыеПоДолгосрочнымДоговорам КАК ПринятыеПоДолгосрочнымДоговорам
	|			ПО Иностр.Физлицо = ПринятыеПоДолгосрочнымДоговорам.Физлицо
	|				И Иностр.Месяц = ПринятыеПоДолгосрочнымДоговорам.Месяц
	|		ПО Основная.ФизЛицо = Иностр.Физлицо
	|			И Основная.Месяц = Иностр.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОбИнвалидности КАК Инвалид
	|		ПО Основная.ФизЛицо = Инвалид.Физлицо
	|			И Основная.Месяц = Инвалид.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИспользуемыеТарифы КАК ИспользуемыеТарифы
	|		ПО Основная.Месяц = ИспользуемыеТарифы.Месяц
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОписаниеТарифов КАК ОписаниеТарифов
	|		ПО (ВЫБОР
	|				КОГДА Основная.ЯвляетсяДоходомФармацевта
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляФармацевтовАптек)
	|				КОГДА Основная.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляЧленовЭкипажейМорскихСудовПодФлагомРФ)
	|				ИНАЧЕ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов
	|			КОНЕЦ = ОписаниеТарифов.ВидТарифа)
	|ГДЕ
	|	(НЕ Основная.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	Основная.ФизЛицо,
	|	Основная.Месяц,
	|	Основная.Период,
	|	ВЫБОР
	|		КОГДА Инвалид.Физлицо ЕСТЬ НЕ NULL 
	|				И ОписаниеТарифов.ВыделятьДоходыИнвалидов
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОрганизацияИнвалидов)
	|		КОГДА Основная.ЯвляетсяДоходомФармацевта
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляФармацевтовАптек)
	|		КОГДА Основная.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ДляЧленовЭкипажейМорскихСудовПодФлагомРФ)
	|		ИНАЧЕ ИспользуемыеТарифы.ВидТарифаСтраховыхВзносов
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ГОД(Основная.ФизЛицо.ДатаРождения) < 1967
	|			ТОГДА ЛОЖЬ
	|		КОГДА Иностр.ВидЗастрахованногоЛица = ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ВременноПребывающиеИностранцы)
	|			ТОГДА ЛОЖЬ
	|		КОГДА Иностр.ВидЗастрахованногоЛица = ЗНАЧЕНИЕ(Перечисление.ВидыЗастрахованныхЛицОбязательногоСтрахования.ВременноПроживающиеИностранцы)
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Месяц,
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) КАК Период,
	|	СУММА(СведенияОДоходах.БазаПФР) КАК ЗаГод,
	|	СУММА(ВЫБОР
	|			КОГДА НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) = СведенияОДоходах.Период
	|				ТОГДА СведенияОДоходах.БазаПФР
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ЗаМесяц,
	|	СУММА(СведенияОДоходах.БазаФОМС) КАК ЗаГодФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) = СведенияОДоходах.Период
	|				ТОГДА СведенияОДоходах.БазаФОМС
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ЗаМесяцФОМС,
	|	СУММА(СведенияОДоходах.БазаФСС) КАК ЗаГодФСС,
	|	СУММА(ВЫБОР
	|			КОГДА НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) = СведенияОДоходах.Период
	|				ТОГДА СведенияОДоходах.БазаФСС
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ЗаМесяцФСС
	|ПОМЕСТИТЬ ВТБазаНарастающимИтогом
	|ИЗ
	|	ВТПериоды КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыЗастрахованныхЛиц КАК СведенияОДоходах
	|		ПО (СведенияОДоходах.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период)
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо,
	|	Периоды.Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОблагаемаяБаза.Период КАК Период,
	|	ВЫБОР
	|		КОГДА ОблагаемаяБаза.ЗаГод - &ПредельнаяСумма >= 0
	|			ТОГДА ОблагаемаяБаза.ЗаГод - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ - ВЫБОР
	|		КОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГод, 0) - &ПредельнаяСумма >= 0
	|			ТОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГод, 0) - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПревысившаяПредел,
	|	ВЫБОР
	|		КОГДА ОблагаемаяБаза.ЗаГодФОМС - &ПредельнаяСумма >= 0
	|			ТОГДА ОблагаемаяБаза.ЗаГодФОМС - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ - ВЫБОР
	|		КОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГодФОМС, 0) - &ПредельнаяСумма >= 0
	|			ТОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГодФОМС, 0) - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПревысившаяПределФОМС,
	|	ВЫБОР
	|		КОГДА ОблагаемаяБаза.ЗаГодФСС - &ПредельнаяСумма >= 0
	|			ТОГДА ОблагаемаяБаза.ЗаГодФСС - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ - ВЫБОР
	|		КОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГодФСС, 0) - &ПредельнаяСумма >= 0
	|			ТОГДА ЕСТЬNULL(ОблагаемаяБазаПрошлогоМесяца.ЗаГодФСС, 0) - &ПредельнаяСумма
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПревысившаяПределФСС
	|ПОМЕСТИТЬ ВТБазаПревышенияДохода
	|ИЗ
	|	ВТБазаНарастающимИтогом КАК ОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаНарастающимИтогом КАК ОблагаемаяБазаПрошлогоМесяца
	|		ПО ОблагаемаяБаза.ФизЛицо = ОблагаемаяБазаПрошлогоМесяца.ФизЛицо
	|			И (ОблагаемаяБаза.Период = ДОБАВИТЬКДАТЕ(ОблагаемаяБазаПрошлогоМесяца.Период, МЕСЯЦ, 1))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыЗастрахованныхЛиц.ФизЛицо,
	|	ДоходыЗастрахованныхЛиц.Период КАК Период,
	|	ДоходыЗастрахованныхЛиц.ВидТарифаСтраховыхВзносов,
	|	ДоходыЗастрахованныхЛиц.НачислятьНакопительнуюЧасть,
	|	&парамОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	ДоходыЗастрахованныхЛиц.БазаПФР КАК ЗаМесяц,
	|	ДоходыЗастрахованныхЛиц.БазаФСС КАК ЗаМесяцФСС,
	|	ДоходыЗастрахованныхЛиц.БазаФОМС КАК ЗаМесяцФОМС
	|ПОМЕСТИТЬ ВТБазаЗаМесяцПоОбособленноеПодразделение
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть,
	|	СведенияОДоходах.Период КАК Период,
	|	МАКСИМУМ(СведенияОДоходах.ЗаМесяц) КАК ЗаМесяц,
	|	МАКСИМУМ(СведенияОДоходах.ЗаМесяцФОМС) КАК ЗаМесяцФОМС,
	|	МАКСИМУМ(СведенияОДоходах.ЗаМесяцФСС) КАК ЗаМесяцФСС
	|ПОМЕСТИТЬ ВТМаксБазаЗаМесяц
	|ИЗ
	|	ВТБазаЗаМесяцПоОбособленноеПодразделение КАК СведенияОДоходах
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период,
	|	ЗаМесяц
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.Период КАК Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть,
	|	&парамОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	МАКСИМУМ(БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТОбособленноеПодразделениеМаксБазы
	|ИЗ
	|	ВТМаксБазаЗаМесяц КАК СведенияОДоходах
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|		ПО СведенияОДоходах.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|			И СведенияОДоходах.Период = БазаЗаМесяцПоОбособленным.Период
	|			И СведенияОДоходах.ЗаМесяц = БазаЗаМесяцПоОбособленным.ЗаМесяц
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период,
	|	ОбособленноеПодразделение,
	|	ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОблагаемаяБаза.Период КАК Период,
	|	ВЫБОР
	|		КОГДА ПревышениеДоходаПоВсемОП.СуммаПревысившаяПредел = 0
	|				ИЛИ ОблагаемаяБаза.ЗаМесяц = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ((ВЫРАЗИТЬ(ПревышениеДоходаПоВсемОП.СуммаПревысившаяПредел КАК ЧИСЛО(25, 10))) * (ВЫРАЗИТЬ(БазаЗаМесяцПоОбособленным.ЗаМесяц КАК ЧИСЛО(25, 10))) / (ВЫРАЗИТЬ(ОблагаемаяБаза.ЗаМесяц КАК ЧИСЛО(25, 10))) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК СуммаПревысившаяПредел,
	|	БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение,
	|	БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов,
	|	БазаЗаМесяцПоОбособленным.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДоходаПоОбособленноеПодразделение
	|ИЗ
	|	ВТБазаНарастающимИтогом КАК ОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаПревышенияДохода КАК ПревышениеДоходаПоВсемОП
	|		ПО ОблагаемаяБаза.ФизЛицо = ПревышениеДоходаПоВсемОП.ФизЛицо
	|			И ОблагаемаяБаза.Период = ПревышениеДоходаПоВсемОП.Период
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазы КАК ОбособленноеПодразделениеДляОкругления
	|			ПО БазаЗаМесяцПоОбособленным.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И БазаЗаМесяцПоОбособленным.Период = ОбособленноеПодразделениеДляОкругления.Период
	|				И БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение = ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение
	|				И БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов = ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов
	|		ПО ОблагаемаяБаза.Период = БазаЗаМесяцПоОбособленным.Период
	|			И ОблагаемаяБаза.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|ГДЕ
	|	ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение ЕСТЬ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СУММА(СуммыПоМесяцам.СуммаПревысившаяПредел) КАК СуммаПревысившаяПредел,
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДохода
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо КАК ФизЛицо,
	|		Превышение.Период КАК Период,
	|		Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел,
	|		Превышение.ВидТарифаСтраховыхВзносов КАК ВидТарифаСтраховыхВзносов,
	|		Превышение.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|		Превышение.НачислятьНакопительнуюЧасть КАК НачислятьНакопительнуюЧасть
	|	ИЗ
	|		ВТПревышениеДоходаПоОбособленноеПодразделение КАК Превышение
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо,
	|		Превышение.Период,
	|		Превышение.СуммаПревысившаяПредел,
	|		ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов,
	|		ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение,
	|		ОбособленноеПодразделениеДляОкругления.НачислятьНакопительнуюЧасть
	|	ИЗ
	|		(ВЫБРАТЬ
	|			Превышение.ФизЛицо КАК ФизЛицо,
	|			Превышение.Период КАК Период,
	|			-Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел
	|		ИЗ
	|			ВТПревышениеДоходаПоОбособленноеПодразделение КАК Превышение
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			Превышение.ФизЛицо,
	|			Превышение.Период,
	|			Превышение.СуммаПревысившаяПредел
	|		ИЗ
	|			ВТБазаПревышенияДохода КАК Превышение) КАК Превышение
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазы КАК ОбособленноеПодразделениеДляОкругления
	|			ПО Превышение.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И Превышение.Период = ОбособленноеПодразделениеДляОкругления.Период) КАК СуммыПоМесяцам
	|ГДЕ
	|	СуммыПоМесяцам.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|	И МЕСЯЦ(СуммыПоМесяцам.Период) <= &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.Период КАК Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть,
	|	&парамОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	МАКСИМУМ(БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТОбособленноеПодразделениеМаксБазыФОМС
	|ИЗ
	|	ВТМаксБазаЗаМесяц КАК СведенияОДоходах
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|		ПО СведенияОДоходах.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|			И СведенияОДоходах.Период = БазаЗаМесяцПоОбособленным.Период
	|			И СведенияОДоходах.ЗаМесяцФОМС = БазаЗаМесяцПоОбособленным.ЗаМесяцФОМС
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период,
	|	ОбособленноеПодразделение,
	|	ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОблагаемаяБаза.Период КАК Период,
	|	ВЫБОР
	|		КОГДА ПревышениеДоходаПоВсемОП.СуммаПревысившаяПределФОМС = 0
	|				ИЛИ ОблагаемаяБаза.ЗаМесяцФОМС = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ((ВЫРАЗИТЬ(ПревышениеДоходаПоВсемОП.СуммаПревысившаяПределФОМС КАК ЧИСЛО(25, 10))) * (ВЫРАЗИТЬ(БазаЗаМесяцПоОбособленным.ЗаМесяцФОМС КАК ЧИСЛО(25, 10))) / (ВЫРАЗИТЬ(ОблагаемаяБаза.ЗаМесяцФОМС КАК ЧИСЛО(25, 10))) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК СуммаПревысившаяПредел,
	|	БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение,
	|	БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов,
	|	БазаЗаМесяцПоОбособленным.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДоходаПоОбособленноеПодразделениеФОМС
	|ИЗ
	|	ВТБазаНарастающимИтогом КАК ОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаПревышенияДохода КАК ПревышениеДоходаПоВсемОП
	|		ПО ОблагаемаяБаза.ФизЛицо = ПревышениеДоходаПоВсемОП.ФизЛицо
	|			И ОблагаемаяБаза.Период = ПревышениеДоходаПоВсемОП.Период
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазыФОМС КАК ОбособленноеПодразделениеДляОкругления
	|			ПО БазаЗаМесяцПоОбособленным.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И БазаЗаМесяцПоОбособленным.Период = ОбособленноеПодразделениеДляОкругления.Период
	|				И БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение = ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение
	|				И БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов = ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов
	|		ПО ОблагаемаяБаза.Период = БазаЗаМесяцПоОбособленным.Период
	|			И ОблагаемаяБаза.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|ГДЕ
	|	ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение ЕСТЬ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СуммыПоМесяцам.ФизЛицо,
	|	СУММА(СуммыПоМесяцам.СуммаПревысившаяПредел) КАК СуммаПревысившаяПредел,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДоходаФОМС
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо КАК ФизЛицо,
	|		Превышение.Период КАК Период,
	|		Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел,
	|		Превышение.ВидТарифаСтраховыхВзносов КАК ВидТарифаСтраховыхВзносов,
	|		Превышение.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|		Превышение.НачислятьНакопительнуюЧасть КАК НачислятьНакопительнуюЧасть
	|	ИЗ
	|		ВТПревышениеДоходаПоОбособленноеПодразделениеФОМС КАК Превышение
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо,
	|		Превышение.Период,
	|		Превышение.СуммаПревысившаяПредел,
	|		ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов,
	|		ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение,
	|		ОбособленноеПодразделениеДляОкругления.НачислятьНакопительнуюЧасть
	|	ИЗ
	|		(ВЫБРАТЬ
	|			Превышение.ФизЛицо КАК ФизЛицо,
	|			Превышение.Период КАК Период,
	|			-Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел
	|		ИЗ
	|			ВТПревышениеДоходаПоОбособленноеПодразделениеФОМС КАК Превышение
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			Превышение.ФизЛицо,
	|			Превышение.Период,
	|			Превышение.СуммаПревысившаяПределФОМС
	|		ИЗ
	|			ВТБазаПревышенияДохода КАК Превышение) КАК Превышение
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазыФОМС КАК ОбособленноеПодразделениеДляОкругления
	|			ПО Превышение.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И Превышение.Период = ОбособленноеПодразделениеДляОкругления.Период) КАК СуммыПоМесяцам
	|ГДЕ
	|	СуммыПоМесяцам.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|	И МЕСЯЦ(СуммыПоМесяцам.Период) <= &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.Период КАК Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть,
	|	&парамОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	МАКСИМУМ(БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов) КАК ВидТарифаСтраховыхВзносов
	|ПОМЕСТИТЬ ВТОбособленноеПодразделениеМаксБазыФСС
	|ИЗ
	|	ВТМаксБазаЗаМесяц КАК СведенияОДоходах
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|		ПО СведенияОДоходах.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|			И СведенияОДоходах.Период = БазаЗаМесяцПоОбособленным.Период
	|			И СведенияОДоходах.ЗаМесяцФСС = БазаЗаМесяцПоОбособленным.ЗаМесяцФСС
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо,
	|	СведенияОДоходах.Период,
	|	СведенияОДоходах.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период,
	|	ОбособленноеПодразделение,
	|	ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ОблагаемаяБаза.Период КАК Период,
	|	ВЫБОР
	|		КОГДА ПревышениеДоходаПоВсемОП.СуммаПревысившаяПределФСС = 0
	|				ИЛИ ОблагаемаяБаза.ЗаМесяцФСС = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ((ВЫРАЗИТЬ(ПревышениеДоходаПоВсемОП.СуммаПревысившаяПределФСС КАК ЧИСЛО(25, 10))) * (ВЫРАЗИТЬ(БазаЗаМесяцПоОбособленным.ЗаМесяцФСС КАК ЧИСЛО(25, 10))) / (ВЫРАЗИТЬ(ОблагаемаяБаза.ЗаМесяцФСС КАК ЧИСЛО(25, 10))) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК СуммаПревысившаяПредел,
	|	БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение,
	|	БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов,
	|	БазаЗаМесяцПоОбособленным.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДоходаПоОбособленноеПодразделениеФСС
	|ИЗ
	|	ВТБазаНарастающимИтогом КАК ОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаПревышенияДохода КАК ПревышениеДоходаПоВсемОП
	|		ПО ОблагаемаяБаза.ФизЛицо = ПревышениеДоходаПоВсемОП.ФизЛицо
	|			И ОблагаемаяБаза.Период = ПревышениеДоходаПоВсемОП.Период
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаЗаМесяцПоОбособленноеПодразделение КАК БазаЗаМесяцПоОбособленным
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазыФСС КАК ОбособленноеПодразделениеДляОкругления
	|			ПО БазаЗаМесяцПоОбособленным.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И БазаЗаМесяцПоОбособленным.Период = ОбособленноеПодразделениеДляОкругления.Период
	|				И БазаЗаМесяцПоОбособленным.ОбособленноеПодразделение = ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение
	|				И БазаЗаМесяцПоОбособленным.ВидТарифаСтраховыхВзносов = ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов
	|		ПО ОблагаемаяБаза.Период = БазаЗаМесяцПоОбособленным.Период
	|			И ОблагаемаяБаза.ФизЛицо = БазаЗаМесяцПоОбособленным.ФизЛицо
	|ГДЕ
	|	ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение ЕСТЬ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СуммыПоМесяцам.ФизЛицо,
	|	СУММА(СуммыПоМесяцам.СуммаПревысившаяПредел) КАК СуммаПревысившаяПредел,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|ПОМЕСТИТЬ ВТПревышениеДоходаФСС
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо КАК ФизЛицо,
	|		Превышение.Период КАК Период,
	|		Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел,
	|		Превышение.ВидТарифаСтраховыхВзносов КАК ВидТарифаСтраховыхВзносов,
	|		Превышение.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|		Превышение.НачислятьНакопительнуюЧасть КАК НачислятьНакопительнуюЧасть
	|	ИЗ
	|		ВТПревышениеДоходаПоОбособленноеПодразделениеФСС КАК Превышение
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		Превышение.ФизЛицо,
	|		Превышение.Период,
	|		Превышение.СуммаПревысившаяПредел,
	|		ОбособленноеПодразделениеДляОкругления.ВидТарифаСтраховыхВзносов,
	|		ОбособленноеПодразделениеДляОкругления.ОбособленноеПодразделение,
	|		ОбособленноеПодразделениеДляОкругления.НачислятьНакопительнуюЧасть
	|	ИЗ
	|		(ВЫБРАТЬ
	|			Превышение.ФизЛицо КАК ФизЛицо,
	|			Превышение.Период КАК Период,
	|			-Превышение.СуммаПревысившаяПредел КАК СуммаПревысившаяПредел
	|		ИЗ
	|			ВТПревышениеДоходаПоОбособленноеПодразделениеФСС КАК Превышение
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			Превышение.ФизЛицо,
	|			Превышение.Период,
	|			Превышение.СуммаПревысившаяПределФСС
	|		ИЗ
	|			ВТБазаПревышенияДохода КАК Превышение) КАК Превышение
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбособленноеПодразделениеМаксБазыФСС КАК ОбособленноеПодразделениеДляОкругления
	|			ПО Превышение.ФизЛицо = ОбособленноеПодразделениеДляОкругления.ФизЛицо
	|				И Превышение.Период = ОбособленноеПодразделениеДляОкругления.Период) КАК СуммыПоМесяцам
	|ГДЕ
	|	СуммыПоМесяцам.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|	И МЕСЯЦ(СуммыПоМесяцам.Период) <= &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов,
	|	СуммыПоМесяцам.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СуммыПоМесяцам.ФизЛицо,
	|	СуммыПоМесяцам.ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыЗастрахованныхЛиц.ФизЛицо,
	|	ДоходыЗастрахованныхЛиц.НачислятьНакопительнуюЧасть,
	|	ДоходыЗастрахованныхЛиц.ВидТарифаСтраховыхВзносов,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаПФР) КАК БазаПФР,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФСС) КАК БазаФСС,
	|	СУММА(ДоходыЗастрахованныхЛиц.БазаФОМС) КАК БазаФОМС
	|ПОМЕСТИТЬ ВТНеОграниченнаяОблагаемаяБаза
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК ДоходыЗастрахованныхЛиц
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыЗастрахованныхЛиц.ФизЛицо,
	|	ДоходыЗастрахованныхЛиц.НачислятьНакопительнуюЧасть,
	|	ДоходыЗастрахованныхЛиц.ВидТарифаСтраховыхВзносов
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НеОграниченнаяОблагаемаяБаза.ФизЛицо КАК ФизЛицо,
	|	ВЫРАЗИТЬ((НеОграниченнаяОблагаемаяБаза.БазаПФР - ЕСТЬNULL(ПревышениеДоходаПФР.СуммаПревысившаяПредел, 0)) * ВЫБОР
	|			КОГДА НеОграниченнаяОблагаемаяБаза.НачислятьНакопительнуюЧасть
	|				ТОГДА ОсновнойТариф.ПФРНакопительная
	|			ИНАЧЕ 0
	|		КОНЕЦ / 100 КАК ЧИСЛО(15, 2)) КАК РезультатПФРНакопительная,
	|	(ВЫРАЗИТЬ((НеОграниченнаяОблагаемаяБаза.БазаПФР - ЕСТЬNULL(ПревышениеДоходаПФР.СуммаПревысившаяПредел, 0)) * (ОсновнойТариф.ПФР - ВЫБОР
	|			КОГДА НеОграниченнаяОблагаемаяБаза.НачислятьНакопительнуюЧасть
	|				ТОГДА ОсновнойТариф.ПФРНакопительная
	|			ИНАЧЕ 0
	|		КОНЕЦ) / 100 КАК ЧИСЛО(15, 2))) + (ВЫРАЗИТЬ(ВЫБОР
	|			КОГДА НеОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов В (ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ОбщийНалоговыйРежим), ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ЕНВД), ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.УпрощенныйНалоговыйРежим))
	|				ТОГДА ЕСТЬNULL(ПревышениеДоходаПФР.СуммаПревысившаяПредел, 0) * 0.1
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ЧИСЛО(15, 2))) КАК РезультатПФРСтраховая,
	|	ВЫРАЗИТЬ((НеОграниченнаяОблагаемаяБаза.БазаФСС - ЕСТЬNULL(ПревышениеДоходаФСС.СуммаПревысившаяПредел, 0)) * ОсновнойТариф.ФСС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФСС,
	|	ВЫРАЗИТЬ((НеОграниченнаяОблагаемаяБаза.БазаФОМС - ЕСТЬNULL(ПревышениеДоходаФОМС.СуммаПревысившаяПредел, 0)) * ОсновнойТариф.ФФОМС / 100 КАК ЧИСЛО(15, 2)) КАК РезультатФФОМС
	|ПОМЕСТИТЬ ВТИсчисленоПоОсновномуТарифу
	|ИЗ
	|	ВТНеОграниченнаяОблагаемаяБаза КАК НеОграниченнаяОблагаемаяБаза
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТТарифы КАК ОсновнойТариф
	|		ПО НеОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ОсновнойТариф.ВидТарифа
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПревышениеДохода КАК ПревышениеДоходаПФР
	|		ПО НеОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ПревышениеДоходаПФР.ВидТарифаСтраховыхВзносов
	|			И НеОграниченнаяОблагаемаяБаза.ФизЛицо = ПревышениеДоходаПФР.ФизЛицо
	|			И НеОграниченнаяОблагаемаяБаза.НачислятьНакопительнуюЧасть = ПревышениеДоходаПФР.НачислятьНакопительнуюЧасть
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПревышениеДоходаФСС КАК ПревышениеДоходаФСС
	|		ПО НеОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ПревышениеДоходаФСС.ВидТарифаСтраховыхВзносов
	|			И НеОграниченнаяОблагаемаяБаза.ФизЛицо = ПревышениеДоходаФСС.ФизЛицо
	|			И НеОграниченнаяОблагаемаяБаза.НачислятьНакопительнуюЧасть = ПревышениеДоходаФСС.НачислятьНакопительнуюЧасть
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПревышениеДоходаФОМС КАК ПревышениеДоходаФОМС
	|		ПО НеОграниченнаяОблагаемаяБаза.ВидТарифаСтраховыхВзносов = ПревышениеДоходаФОМС.ВидТарифаСтраховыхВзносов
	|			И НеОграниченнаяОблагаемаяБаза.ФизЛицо = ПревышениеДоходаФОМС.ФизЛицо
	|			И НеОграниченнаяОблагаемаяБаза.НачислятьНакопительнуюЧасть = ПревышениеДоходаФОМС.НачислятьНакопительнуюЧасть
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(ДоходыФизлиц.ОблагаемыйДоход) * 0.14 КАК ЧИСЛО(15, 2)) КАК РезультатПоДополнительномуТарифу,
	|	ДоходыФизлиц.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТВзносыПоДополнительномуТарифу
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК ДоходыФизлиц
	|ГДЕ
	|	ДоходыФизлиц.ОблагаетсяПоДополнительномуТарифу
	|	И ДоходыФизлиц.ВходитВБазуПФР
	|	И (НЕ ДоходыФизлиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫРАЗИТЬ(СУММА(ДоходыФизлиц.ОблагаемыйДоход) * 0.067 КАК ЧИСЛО(15, 2)) КАК РезультатПоДополнительномуТарифу,
	|	ДоходыФизлиц.ФизЛицо КАК ФизЛицо
	|ПОМЕСТИТЬ ВТВзносыДляШахтеров
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК ДоходыФизлиц
	|ГДЕ
	|	ДоходыФизлиц.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам
	|	И ДоходыФизлиц.ВходитВБазуПФР
	|	И (НЕ ДоходыФизлиц.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыФизлиц.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Начислено.ФизЛицо КАК ФизЛицо,
	|	(ВЫРАЗИТЬ(СУММА(Начислено.БазаФСС_НСПоОсновномуТарифу) * &СтавкаВзносаФСС_НС_ПЗ КАК ЧИСЛО(18, 5))) + (ВЫРАЗИТЬ(СУММА(Начислено.БазаФСС_НСИнвалида) * &СтавкаВзносаФСС_НС_ПЗ * 0.6 КАК ЧИСЛО(18, 5))) - МАКСИМУМ(ЕСТЬNULL(РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот, 0)) КАК Взносов
	|ПОМЕСТИТЬ ВТВзносыФССНесчастныеСлучаи
	|ИЗ
	|	ВТДоходыЗастрахованныхЛиц КАК Начислено
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРанееИсчисленныеВзносы КАК РанееИсчисленныеВзносы
	|		ПО Начислено.ФизЛицо = РанееИсчисленныеВзносы.ФизЛицо
	|ГДЕ
	|	Начислено.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	Начислено.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Начислено.Взносов - РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот КАК Взносов
	|ПОМЕСТИТЬ ВТВзносыФССНесчастныеСлучаиСводно
	|ИЗ
	|	(ВЫБРАТЬ
	|		(ВЫРАЗИТЬ(СУММА(Начислено.БазаФСС_НСПоОсновномуТарифу) * &СтавкаВзносаФСС_НС_ПЗ КАК ЧИСЛО(15, 2))) + (ВЫРАЗИТЬ(СУММА(Начислено.БазаФСС_НСИнвалида) * &СтавкаВзносаФСС_НС_ПЗ * 0.6 КАК ЧИСЛО(15, 2))) КАК Взносов
	|	ИЗ
	|		ВТДоходыЗастрахованныхЛиц КАК Начислено
	|	ГДЕ
	|		Начислено.Месяц = &парамМесяцРасчета) КАК Начислено
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			СУММА(РанееИсчисленныеВзносы.ФССНесчастныеСлучаиОборот) КАК ФССНесчастныеСлучаиОборот
	|		ИЗ
	|			ВТРанееИсчисленныеВзносы КАК РанееИсчисленныеВзносы) КАК РанееИсчисленныеВзносы
	|		ПО (ИСТИНА)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВсегоИсчислено.ФизЛицо КАК ФизЛицо,
	|	ВсегоИсчислено.Порядок,
	|	ВЫРАЗИТЬ(СУММА(ВсегоИсчислено.РезультатПФРНакопительная) КАК ЧИСЛО(15, 2)) КАК РезультатПФРНакопительная,
	|	ВЫРАЗИТЬ(СУММА(ВсегоИсчислено.РезультатПФРСтраховая) КАК ЧИСЛО(15, 2)) КАК РезультатПФРСтраховая,
	|	ВЫРАЗИТЬ(СУММА(ВсегоИсчислено.РезультатФСС) КАК ЧИСЛО(15, 2)) КАК РезультатФСС,
	|	ВЫРАЗИТЬ(СУММА(ВсегоИсчислено.РезультатФФОМС) КАК ЧИСЛО(15, 2)) КАК РезультатФФОМС,
	|	СУММА(ВсегоИсчислено.РезультатПоДополнительномуТарифу) КАК РезультатПоДополнительномуТарифу,
	|	СУММА(ВсегоИсчислено.РезультатФССНесчастныеСлучаи) КАК РезультатФССНесчастныеСлучаи,
	|	СУММА(ВсегоИсчислено.РезультатДляШахтеров) КАК РезультатДляШахтеров
	|ПОМЕСТИТЬ ВТСуммыВзносовНарастающимИтогом
	|ИЗ
	|	(ВЫБРАТЬ
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо КАК ФизЛицо,
	|		ИсчисленоПоОсновномуТарифу.ФизЛицо.Наименование КАК Порядок,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРНакопительная КАК РезультатПФРНакопительная,
	|		ИсчисленоПоОсновномуТарифу.РезультатПФРСтраховая КАК РезультатПФРСтраховая,
	|		ИсчисленоПоОсновномуТарифу.РезультатФСС КАК РезультатФСС,
	|		ИсчисленоПоОсновномуТарифу.РезультатФФОМС КАК РезультатФФОМС,
	|		0 КАК РезультатПоДополнительномуТарифу,
	|		0 КАК РезультатФССНесчастныеСлучаи,
	|		0 КАК РезультатДляШахтеров
	|	ИЗ
	|		ВТИсчисленоПоОсновномуТарифу КАК ИсчисленоПоОсновномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыПоДополнительномуТарифу.ФизЛицо,
	|		ВзносыПоДополнительномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыПоДополнительномуТарифу.РезультатПоДополнительномуТарифу,
	|		0,
	|		0
	|	ИЗ
	|		ВТВзносыПоДополнительномуТарифу КАК ВзносыПоДополнительномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыПоДополнительномуТарифу.ФизЛицо,
	|		ВзносыПоДополнительномуТарифу.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыПоДополнительномуТарифу.РезультатПоДополнительномуТарифу
	|	ИЗ
	|		ВТВзносыДляШахтеров КАК ВзносыПоДополнительномуТарифу
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВзносыФС_НС_ПЗ.ФизЛицо,
	|		ВзносыФС_НС_ПЗ.ФизЛицо.Наименование,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВзносыФС_НС_ПЗ.Взносов,
	|		0
	|	ИЗ
	|		ВТВзносыФССНесчастныеСлучаи КАК ВзносыФС_НС_ПЗ) КАК ВсегоИсчислено
	|
	|СГРУППИРОВАТЬ ПО
	|	ВсегоИсчислено.ФизЛицо,
	|	ВсегоИсчислено.Порядок
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СуммыНарастающимИтогом.ФизЛицо КАК ФизЛицо,
	|	СуммыНарастающимИтогом.Порядок КАК Порядок,
	|	СуммыНарастающимИтогом.РезультатФСС - ЕСТЬNULL(ИсчисленныеВзносы.ФССОборот, 0) КАК ФСС,
	|	СуммыНарастающимИтогом.РезультатФФОМС - ЕСТЬNULL(ИсчисленныеВзносы.ФФОМСОборот, 0) КАК ФФОМС,
	|	СуммыНарастающимИтогом.РезультатПФРНакопительная - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНакопительнаяОборот, 0) КАК ПФРНакопительная,
	|	СуммыНарастающимИтогом.РезультатПФРСтраховая - ЕСТЬNULL(ИсчисленныеВзносы.ПФРСтраховаяОборот, 0) КАК ПФРСтраховая,
	|	СуммыНарастающимИтогом.РезультатПоДополнительномуТарифу - ЕСТЬNULL(ИсчисленныеВзносы.ПФРПоДополнительномуТарифуОборот, 0) КАК ПФРПоДополнительномуТарифу,
	|	СуммыНарастающимИтогом.РезультатФССНесчастныеСлучаи КАК ФССНесчастныеСлучаи,
	|	СуммыНарастающимИтогом.РезультатДляШахтеров - ЕСТЬNULL(ИсчисленныеВзносы.ПФРНаДоплатуКПенсииШахтерамОборот, 0) КАК ПФРНаДоплатуКПенсииШахтерам
	|ПОМЕСТИТЬ ВТВзносыЗаМесяц
	|ИЗ
	|	ВТСуммыВзносовНарастающимИтогом КАК СуммыНарастающимИтогом
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРанееИсчисленныеВзносы КАК ИсчисленныеВзносы
	|		ПО СуммыНарастающимИтогом.ФизЛицо = ИсчисленныеВзносы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Порядок
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Основная.ФизЛицо КАК ФизЛицо,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФР,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФСС,
	|	СУММА(ВЫБОР
	|			КОГДА (НЕ Основная.ОблагаетсяЕНВД)
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМС,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуПФР
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаПФРЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуФСС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФССЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Основная.ОблагаетсяЕНВД
	|					И Основная.ВходитВБазуФОМС
	|				ТОГДА Основная.ОблагаемыйДоход
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК БазаФОМСЕНВД
	|ПОМЕСТИТЬ ВТРаспределениеДоходовПоЕНВД
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК Основная
	|ГДЕ
	|	(НЕ Основная.ФизЛицо В
	|				(ВЫБРАТЬ
	|					СписокСотрудников.ФизЛицо
	|				ИЗ
	|					ВТФизлицаБезОблагаемойБазы КАК СписокСотрудников))
	|	И Основная.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	Основная.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА СУММА(ВЫБОР
	|						КОГДА СведенияОДоходах.ОблагаетсяЕНВД
	|							ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|						ИНАЧЕ 0
	|					КОНЕЦ) > 0
	|				И СУММА(ВЫБОР
	|						КОГДА (НЕ СведенияОДоходах.ОблагаетсяЕНВД)
	|							ТОГДА СведенияОДоходах.ОблагаемыйДоход
	|						ИНАЧЕ 0
	|					КОНЕЦ) = 0
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ТолькоЕНВД,
	|	СведенияОДоходах.ФизЛицо
	|ПОМЕСТИТЬ ВТВидыДеятельности
	|ИЗ
	|	ВТДоходыПоФизлицамМесяцам КАК СведенияОДоходах
	|ГДЕ
	|	СведенияОДоходах.Месяц = &парамМесяцРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОДоходах.ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Взносы.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ФФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ФФОМС - (ВЫРАЗИТЬ(Взносы.ФФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ФФОМС,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ФФОМС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ФФОМС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФОМС + РаспределениеДоходовПоЕНВД.БазаФОМСЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ФФОМСЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ФСС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ФСС - (ВЫРАЗИТЬ(Взносы.ФСС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ФСС,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ФСС
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ФСС * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаФСС + РаспределениеДоходовПоЕНВД.БазаФССЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ФССЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ПФРНакопительная
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ПФРНакопительная - (ВЫРАЗИТЬ(Взносы.ПФРНакопительная * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ПФРНакопительная,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ПФРНакопительная
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ПФРНакопительная * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ПФРНакопительнаяЕНВД,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И (НЕ ВидыДеятельности.ТолькоЕНВД)
	|			ТОГДА Взносы.ПФРСтраховая
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ Взносы.ПФРСтраховая - (ВЫРАЗИТЬ(Взносы.ПФРСтраховая * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2)))
	|	КОНЕЦ КАК ПФРСтраховая,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|				И ВидыДеятельности.ТолькоЕНВД
	|			ТОГДА Взносы.ПФРСтраховая
	|		КОГДА ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫРАЗИТЬ(Взносы.ПФРСтраховая * ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) / ЕСТЬNULL(РаспределениеДоходовПоЕНВД.БазаПФР + РаспределениеДоходовПоЕНВД.БазаПФРЕНВД, 0) КАК ЧИСЛО(15, 2))
	|	КОНЕЦ КАК ПФРСтраховаяЕНВД,
	|	Взносы.ПФРПоДополнительномуТарифу,
	|	Взносы.ФССНесчастныеСлучаи,
	|	Взносы.ПФРНаДоплатуКПенсииШахтерам
	|ИЗ
	|	ВТВзносыЗаМесяц КАК Взносы
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРаспределениеДоходовПоЕНВД КАК РаспределениеДоходовПоЕНВД
	|		ПО Взносы.ФизЛицо = РаспределениеДоходовПоЕНВД.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТВидыДеятельности КАК ВидыДеятельности
	|		ПО Взносы.ФизЛицо = ВидыДеятельности.ФизЛицо
	|ГДЕ
	|	(Взносы.ФСС <> 0
	|			ИЛИ Взносы.ФФОМС <> 0
	|			ИЛИ Взносы.ПФРНакопительная <> 0
	|			ИЛИ Взносы.ПФРСтраховая <> 0
	|			ИЛИ Взносы.ПФРПоДополнительномуТарифу <> 0
	|			ИЛИ Взносы.ПФРНаДоплатуКПенсииШахтерам <> 0
	|			ИЛИ Взносы.ФССНесчастныеСлучаи <> 0)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Взносы.Порядок";

	Запрос.Текст = СтрЗаменить(Запрос.Текст,"РегистрСведений.УчетнаяПолитикаНалоговыйУчет", ЗаполнениеРегламентированнойОтчетностиПереопределяемый.ИмяУчетнойПолитики());
	ВременнаяТаблица = Запрос.Выполнить().Выгрузить();
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Начислено.Взносов КАК ВзносовСводно
	|ИЗ
	|	ВТВзносыФССНесчастныеСлучаиСводно КАК Начислено";
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() И ЗначениеЗаполнено(Выборка.ВзносовСводно) Тогда
		ЗаполнениеРегламентированнойОтчетности.ОкруглитьСлагаемыеПоСумме(ВременнаяТаблица,"ФССНесчастныеСлучаи", Выборка.ВзносовСводно, 2, "ФизЛицо");
	КонецЕсли;
	
	Возврат ВременнаяТаблица;
	
КонецФункции  // ПолучитьДанныеРасчета

// расчет документа
//
Процедура РассчитатьВзносы(ВыборкаПоШапкеДокумента, ОграничениеНаСотрудников = Неопределено)
	
	НаборЗаписейОДоходах = РегистрыНакопления.СтраховыеВзносыСведенияОДоходах.СоздатьНаборЗаписей().ВыгрузитьКолонки();
	
	Отказ = Ложь;
	РасчетСтраховыхВзносовПереопределяемый.СформироватьДвиженияПоДоходам(ЭтотОбъект, ВыборкаПоШапкеДокумента, "", Отказ, НаборЗаписейОДоходах);
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	СформироватьДвиженияПоСкидкам(ВыборкаПоШапкеДокумента, НаборЗаписейОДоходах);
	
	Если ПериодРегистрации < ПроведениеРасчетов.ДатаРасширенияПеречняЛьготныхТарифовСтраховыхВзносов() Тогда
		ИсчисленныеСтраховыеВзносы.Загрузить(ПолучитьДанныеРасчетаЗа2010Год(ВыборкаПоШапкеДокумента.Организация, ОграничениеНаСотрудников, НаборЗаписейОДоходах, Отказ));	
	ИначеЕсли ПериодРегистрации < ПроведениеРасчетов.ДатаСниженияТарифовСтраховыхВзносов() Тогда
		ИсчисленныеСтраховыеВзносы.Загрузить(ПолучитьДанныеРасчетаЗа2011Год(ВыборкаПоШапкеДокумента.Организация, ОграничениеНаСотрудников, НаборЗаписейОДоходах, Отказ));	
	Иначе
		ИсчисленныеСтраховыеВзносы.Загрузить(ПолучитьДанныеРасчета(ВыборкаПоШапкеДокумента.Организация, ОграничениеНаСотрудников, НаборЗаписейОДоходах, Отказ));	
	КонецЕсли;
	
КонецПроцедуры // РассчитатьВзносы()

////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// заполнение доходов и расчет документа
Процедура ЗаполнитьИРассчитать(Скидки = Истина, Взносы = Истина) Экспорт

	Если Не Скидки И Не Взносы Тогда  // делать ничего не надо
		Возврат
	КонецЕсли;
	
	Отказ = Ложь;
	
	мГоловнаяОрганизация = ОбщегоНазначения.ГоловнаяОрганизация(Организация);
	ОписаниеДокумента = Новый Структура;
	ОписаниеДокумента.Вставить("Организация",				мГоловнаяОрганизация);
	ОписаниеДокумента.Вставить("ОрганизацияПредставление",	Строка(мГоловнаяОрганизация));
	ОписаниеДокумента.Вставить("ОбособленноеПодразделение",	Организация);
	ОписаниеДокумента.Вставить("Ссылка",					Ссылка);
	ОписаниеДокумента.Вставить("Год",						Год(ПериодРегистрации));
	ОписаниеДокумента.Вставить("Период",					ПериодРегистрации);
	ОписаниеДокумента.Вставить("ПериодРегистрации",			ПериодРегистрации);
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ГоловнаяОрганизация",мГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ПериодРегистрации",ПериодРегистрации);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА УчетнаяПолитикаНалоговыйУчетСрезПоследних.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ПустаяСсылка)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК НеУказанВидТарифа
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаНалоговыйУчет.СрезПоследних(&ПериодРегистрации, Организация = &ГоловнаяОрганизация) КАК УчетнаяПолитикаНалоговыйУчетСрезПоследних";
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"РегистрСведений.УчетнаяПолитикаНалоговыйУчет", ЗаполнениеРегламентированнойОтчетностиПереопределяемый.ИмяУчетнойПолитики());
	Выборка = Запрос.Выполнить().Выбрать();
	НеУказанВидТарифа = Ложь;
	Если Выборка.Следующий() Тогда
		НеУказанВидТарифа = Выборка.НеУказанВидТарифа
	КонецЕсли;
	ОписаниеДокумента.Вставить("НеУказанВидТарифа", НеУказанВидТарифа);
	
	ПроверитьЗаполнениеШапки(ОписаниеДокумента, Отказ);
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	Если Взносы Тогда // выберем сотрудников для последующей обработки
		ОграничениеНаСотрудников = ПолучитьОграничениеНаСотрудников(Отказ);	
		Если Отказ Тогда
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	Если Скидки И Взносы Тогда // надо полностью перезаполнить данные о доходах
		РасчетСтраховыхВзносовПереопределяемый.Автозаполнение(ЭтотОбъект, ОписаниеДокумента, ОграничениеНаСотрудников, Отказ);
		Если Отказ Тогда
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	Если Скидки и Не Взносы Тогда // только пересчет скидок к доходам
		РасчетСкидок(ОписаниеДокумента);
	КонецЕсли;
	
	Если Взносы Тогда // полное заполнение или пересчет взносов
		РассчитатьВзносы(ОписаниеДокумента, ОграничениеНаСотрудников);
	КонецЕсли;

КонецПроцедуры

Процедура РасчетСкидок(ВыборкаПоШапкеДокумента) Экспорт
	
	Если НеоблагаемыеСуммыДоходов.Количество() = 0 Тогда  // считать оказалось нечего
		Возврат
	КонецЕсли;
	
	Отказ = Ложь;
	ДанныеОДоходах = РегистрыНакопления.СтраховыеВзносыСведенияОДоходах.СоздатьНаборЗаписей().ВыгрузитьКолонки();
	РасчетСтраховыхВзносовПереопределяемый.СформироватьДвиженияПоДоходам(ЭтотОбъект, ВыборкаПоШапкеДокумента, "", Отказ, ДанныеОДоходах);
	Если Отказ Тогда
		Возврат	
	КонецЕсли;
		
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос.УстановитьПараметр("парамРегистратор",					ВыборкаПоШапкеДокумента.Ссылка);
	Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации",	КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация",			ВыборкаПоШапкеДокумента.Организация);
	Запрос.УстановитьПараметр("парамНачалоГода",					НачалоГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));
	Запрос.УстановитьПараметр("парамФизлица",						НеоблагаемыеСуммыДоходов.ВыгрузитьКолонку("ФизЛицо"));
 	Запрос.УстановитьПараметр("парамДанныеОДоходах",				ДанныеОДоходах);

	Запрос.Текст =
	"ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.ВидДохода КАК ВидДохода,
	|	СведенияОДоходах.Результат
	|ПОМЕСТИТЬ ВТДанныеДокумента
	|ИЗ
	|	&парамДанныеОДоходах КАК СведенияОДоходах
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидДохода,
	|	ФизЛицо";
	Запрос.Выполнить();
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ДоходыПоМесяцам.ВидДохода КАК ВидДохода,
	|	ДоходыПоМесяцам.ФизЛицо,
	|	СУММА(ДоходыПоМесяцам.Результат) КАК РезультатЗаГод,
	|	СУММА(ДоходыПоМесяцам.Скидка) КАК ПредоставленнаяСкидкаЗаГод
	|ИЗ
	|	(ВЫБРАТЬ
	|		СведенияОДоходах.ФизЛицо КАК ФизЛицо,
	|		СведенияОДоходах.РезультатОборот КАК Результат,
	|		СведенияОДоходах.СкидкаОборот КАК Скидка,
	|		СведенияОДоходах.ВидДохода КАК ВидДохода
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыСведенияОДоходах.Обороты(
	|				&парамНачалоГода,
	|				&парамКонецМесяцаПериодаРегистрации,
	|				Месяц,
	|				Организация = &парамГоловнаяОрганизация
	|					И ВидДохода В (ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.МатпомощьПрокуроров), ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.Матпомощь))
	|					И Физлицо В (&парамФизлица)) КАК СведенияОДоходах
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|		-СтраховыеВзносыСведенияОДоходах.Результат,
	|		-СтраховыеВзносыСведенияОДоходах.Скидка,
	|		СтраховыеВзносыСведенияОДоходах.ВидДохода
	|	ИЗ
	|		РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СтраховыеВзносыСведенияОДоходах
	|	ГДЕ
	|		СтраховыеВзносыСведенияОДоходах.Регистратор = &парамРегистратор
	|		И СтраховыеВзносыСведенияОДоходах.ФизЛицо В(&парамФизлица)
	|		И СтраховыеВзносыСведенияОДоходах.ВидДохода В (ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.МатпомощьПрокуроров), ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.Матпомощь))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтраховыеВзносыСведенияОДоходах.ФизЛицо,
	|		СтраховыеВзносыСведенияОДоходах.Результат,
	|		0,
	|		СтраховыеВзносыСведенияОДоходах.ВидДохода
	|	ИЗ
	|		ВТДанныеДокумента КАК СтраховыеВзносыСведенияОДоходах
	|	ГДЕ
	|		СтраховыеВзносыСведенияОДоходах.ФизЛицо В(&парамФизлица)
	|		И СтраховыеВзносыСведенияОДоходах.ВидДохода В (ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.МатпомощьПрокуроров), ЗНАЧЕНИЕ(Справочник.ДоходыПоСтраховымВзносам.Матпомощь))) КАК ДоходыПоМесяцам
	|
	|СГРУППИРОВАТЬ ПО
	|	ДоходыПоМесяцам.ФизЛицо,
	|	ДоходыПоМесяцам.ВидДохода";
	
	СтруктураПоиска = Новый Структура("Физлицо, ВидДохода");
	ПравоНаСкидку = РегистрыСведений.СтраховыеВзносыСкидкиКДоходам.ПолучитьПоследнее(НачалоГода(ВыборкаПоШапкеДокумента.ПериодРегистрации), Новый Структура("ВидДохода", Справочники.ДоходыПоСтраховымВзносам.Матпомощь)).ГодоваяСкидка;
	Если Не ЗначениеЗаполнено(ПравоНаСкидку) Тогда
		ПравоНаСкидку = 0
	КонецЕсли;
	
	МодифицируемаяТаблица = НеоблагаемыеСуммыДоходов.Выгрузить();
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		
		// Распределим скидку между строками о доходах
		ЗаполнитьЗначенияСвойств(СтруктураПоиска, Выборка); // Физлицо, ВидДохода
		
		НайденныеСтроки = МодифицируемаяТаблица.НайтиСтроки(СтруктураПоиска);
		Если НайденныеСтроки.Количество() = 0 Тогда
			Продолжить;
		КонецЕсли; 
		
		// В общем случае предоставляемая скидка есть
		НайденныеСтроки[0].Скидка = Мин(Выборка.РезультатЗаГод, ПравоНаСкидку) - Выборка.ПредоставленнаяСкидкаЗаГод;
		Если НайденныеСтроки.Количество() > 1 Тогда
			Для Сч = 1  По НайденныеСтроки.Количество() - 1 Цикл
				НайденныеСтроки[Сч].Скидка = 0
			КонецЦикла;
		КонецЕсли;
		
	КонецЦикла; 
	
	НеоблагаемыеСуммыДоходов.Загрузить(МодифицируемаяТаблица);

КонецПроцедуры // РасчетСкидок()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ОБЕСПЕЧЕНИЯ ПРОВЕДЕНИЯ ДОКУМЕНТА

/// Формирует запрос по шапке документа
//
// Параметры: 
//	нет
//
// Возвращаемое значение:
//	Результат запроса.
//
Функция СформироватьЗапросПоШапке()

	Запрос = Новый Запрос;

	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
	Запрос.УстановитьПараметр("ПериодРегистрации" , ПериодРегистрации);

	Запрос.Текст = 
	"ВЫБРАТЬ
	|	РасчетСтраховыхВзносов.Ссылка,
	|	РасчетСтраховыхВзносов.Дата,
	|	РасчетСтраховыхВзносов.Организация КАК ОбособленноеПодразделение,
	|	РасчетСтраховыхВзносов.Ответственный,
	|	РасчетСтраховыхВзносов.ПериодРегистрации КАК ПериодРегистрации,
	|	РасчетСтраховыхВзносов.ПериодРегистрации КАК Период,
	|	ГОД(РасчетСтраховыхВзносов.ПериодРегистрации) КАК Год,
	|	ВЫБОР
	|		КОГДА РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА РасчетСтраховыхВзносов.Организация
	|		ИНАЧЕ РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация
	|	КОНЕЦ КАК Организация,
	|	ПРЕДСТАВЛЕНИЕ(ВЫБОР
	|			КОГДА РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|				ТОГДА РасчетСтраховыхВзносов.Организация
	|			ИНАЧЕ РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация
	|		КОНЕЦ) КАК ОрганизацияПредставление,
	|	ВЫБОР
	|		КОГДА УчетнаяПолитикаНалоговыйУчетСрезПоследних.ВидТарифаСтраховыхВзносов = ЗНАЧЕНИЕ(Перечисление.ТарифыСтраховыхВзносов.ПустаяСсылка) 
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК НеУказанВидТарифа
	|ИЗ
	|	Документ.РасчетСтраховыхВзносов КАК РасчетСтраховыхВзносов
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаНалоговыйУчет.СрезПоследних(&ПериодРегистрации, ) КАК УчетнаяПолитикаНалоговыйУчетСрезПоследних
	|		ПО (ВЫБОР
	|				КОГДА РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|					ТОГДА РасчетСтраховыхВзносов.Организация
	|				ИНАЧЕ РасчетСтраховыхВзносов.Организация.ГоловнаяОрганизация
	|			КОНЕЦ = УчетнаяПолитикаНалоговыйУчетСрезПоследних.Организация)
	|ГДЕ
	|	РасчетСтраховыхВзносов.Ссылка = &ДокументСсылка";
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"РегистрСведений.УчетнаяПолитикаНалоговыйУчет", ЗаполнениеРегламентированнойОтчетностиПереопределяемый.ИмяУчетнойПолитики());

	Возврат Запрос.Выполнить();

КонецФункции // СформироватьЗапросПоШапке()

// Проверяет правильность заполнения шапки документа.
// Если какой-то из реквизитов шапки, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по шапке,
// все проверяемые реквизиты должны быть включены в выборку по шапке.
//
// Параметры: 
//	ВыборкаПоШапкеДокумента	- выборка из результата запроса по шапке документа,
//	Отказ					- флаг отказа в проведении,
//	Заголовок				- Заголовок для сообщений об ошибках проведения.
//
Процедура ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок = "")

	Если Не ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.ОбособленноеПодразделение) Тогда
		СтрокаСообщения = ОбщегоНазначения.ПреобразоватьСтрокуИнтерфейса("Не указана организация!");
		ОбщегоНазначения.ВывестиИнформациюОбОшибке(СтрокаСообщения, Отказ, Заголовок);
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Период) Тогда
		ОбщегоНазначения.ВывестиИнформациюОбОшибке("Не указан период регистрации!", Отказ, Заголовок);
	ИначеЕсли ВыборкаПоШапкеДокумента.ПериодРегистрации < ПроведениеРасчетов.ДатаЗаменыЕСНСтраховымиВзносами() Тогда
		ОбщегоНазначения.ВывестиИнформациюОбОшибке("Уплата страховых взносов вводится с 1 января 2010 года!", Отказ);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.ОбособленноеПодразделение) и ПустаяСтрока(Заголовок) Тогда

		Если ВыборкаПоШапкеДокумента.НеУказанВидТарифа Тогда
			
			Расшифровки = Новый Массив;
			// расшифровка сообщений представляет собой массив структур "Представление+Расшифровка"
			ОткрытьСведенияОСтавках = Новый Массив;
			ОткрытьСведенияОСтавках.Добавить("ПроцедурыУправленияПерсоналом.ОткрытьФормуНастройкаПараметровУчета");
			ОткрытьСведенияОСтавках.Добавить("НалоговыйУчет");
			ОткрытьСведенияОСтавках.Добавить(Новый Структура("Организация, Год", ВыборкаПоШапкеДокумента.Организация, ВыборкаПоШапкеДокумента.Год));
			Расшифровки.Добавить(Новый Структура("Представление,Расшифровка", Формат(ВыборкаПоШапкеДокумента.Год, "ЧЦ=4; ЧГ="), ОткрытьСведенияОСтавках));
	
			СтрокаСообщения = ОбщегоНазначения.ПреобразоватьСтрокуИнтерфейса("организации") + " " + ВыборкаПоШапкеДокумента.ОрганизацияПредставление;
			ОбщегоНазначения.ВывестиИнформациюОбОшибке(
			"Для " + СтрокаСообщения + " на %% год не указан вид тарифа страховых взносов в ПФР, ФОМС и ФСС!",
					Отказ, Заголовок, Перечисления.ВидыСообщений.Ошибка, Расшифровки);
					
		КонецЕсли;
		
	КонецЕсли;	
	
КонецПроцедуры // ПроверитьЗаполнениеШапки()

// Выполняет проверку правильности заполнения строки табличной части налогов
Процедура ПроверитьЗаполнениеСтрокиВзносов(ВыборкаПоВзносам, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоВзносам.НомерСтроки) +
	""" табл. части Исчисленные страховые взносы: ";
	
	Если Не ЗначениеЗаполнено(ВыборкаПоВзносам.ФизЛицо) Тогда
		ОбщегоНазначения.ВывестиИнформациюОбОшибке(СтрокаНачалаСообщенияОбОшибке  + "Не указан сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиВзносов()

Процедура ПроверитьЗаполнениеСтрокиСкидок(Выборка, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(Выборка.НомерСтроки) +
	""" табл. части Необлагаемые суммы: ";
	
	Если Не ЗначениеЗаполнено(Выборка.ФизЛицо) Тогда
		ОбщегоНазначения.ВывестиИнформациюОбОшибке(СтрокаНачалаСообщенияОбОшибке  + "Не указан сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиВзносов()

// Добавляет запись в движения по регистру учета налогов
Процедура ДобавитьСтрокуВДвиженияПоВзносам(ВыборкаПоВзносам, ВыборкаПоШапкеДокумента)
	
	СтрокаНабора = Движения.СтраховыеВзносыИсчисленные.Добавить();
	ЗаполнитьЗначенияСвойств(СтрокаНабора,ВыборкаПоШапкеДокумента);
	ЗаполнитьЗначенияСвойств(СтрокаНабора,ВыборкаПоВзносам);
	
КонецПроцедуры // ДобавитьСтрокуВДвиженияПоВзносам()

Процедура СформироватьДвиженияПоСкидкам(ВыборкаПоШапкеДокумента, ДанныеОДоходах = Неопределено)
	
	Если ДанныеОДоходах = Неопределено Тогда
		Отказ = Ложь;
		ДанныеОДоходах = РегистрыНакопления.СтраховыеВзносыСведенияОДоходах.СоздатьНаборЗаписей().ВыгрузитьКолонки();
		РасчетСтраховыхВзносовПереопределяемый.СформироватьДвиженияПоДоходам(ЭтотОбъект, ВыборкаПоШапкеДокумента, "", Отказ, ДанныеОДоходах);
		Если Отказ Тогда
			Возврат	
		КонецЕсли;
		НаборЗаписейОДоходах = Движения.СтраховыеВзносыСведенияОДоходах;
	Иначе
		НаборЗаписейОДоходах = ДанныеОДоходах;
	КонецЕсли;	
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Регистратор",	ВыборкаПоШапкеДокумента.Ссылка);
	Запрос.УстановитьПараметр("ПериодРегистрации",ВыборкаПоШапкеДокумента.ПериодРегистрации);
	Запрос.УстановитьПараметр("НачалоПериода",	НачалоМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
	Запрос.УстановитьПараметр("КонецПериода",	КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
	Запрос.УстановитьПараметр("ОбособленноеПодразделение",	ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);
	Запрос.УстановитьПараметр("ТаблицаДоходов",	ДанныеОДоходах);
	Запрос.УстановитьПараметр("НеоблагаемыеСуммы", НеоблагаемыеСуммыДоходов);
	
	ТаблицаРаспределения = Новый ТаблицаЗначений;
	ТаблицаРаспределения.Колонки.Добавить("ФизЛицо");
	ТаблицаРаспределения.Колонки.Добавить("ВидДохода");
	ТаблицаРаспределения.Колонки.Добавить("ОблагаетсяПоДополнительномуТарифу");
	ТаблицаРаспределения.Колонки.Добавить("ВидРасчета");
	ТаблицаРаспределения.Колонки.Добавить("Результат");
	ТаблицаРаспределения.Колонки.Добавить("ОблагаетсяЕНВД");
	
	Если ПериодРегистрации < ПроведениеРасчетов.ДатаРасширенияПеречняЛьготныхТарифовСтраховыхВзносов() Тогда
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
		|	СтраховыеВзносыСведенияОДоходах.ВидДохода,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
		|	СтраховыеВзносыСведенияОДоходах.Результат,
		|	СтраховыеВзносыСведенияОДоходах.ВидРасчета
		|ПОМЕСТИТЬ ВТДанныеДоходовДокумента
		|ИЗ
		|	&ТаблицаДоходов КАК СтраховыеВзносыСведенияОДоходах
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетИсчисленный.ФизЛицо КАК ФизЛицо,
		|	РасчетИсчисленный.Скидка,
		|	РасчетИсчисленный.ВидДохода КАК ВидДохода
		|ПОМЕСТИТЬ ВТДанныеДокумента
		|ИЗ
		|	&НеоблагаемыеСуммы КАК РасчетИсчисленный
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.Результат КАК Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидРасчета КАК ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу КАК ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТСведенияОДоходах
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &ПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &ОбособленноеПодразделение
		|	И СведенияОДоходах.Регистратор <> &Регистратор
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо,
		|	ДанныеДокумента.ВидДохода,
		|	СведенияОДоходах.Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДанныеДоходовДокумента КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СУММА(СведенияОДоходах.Результат) КАК Результат,
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
		|	СведенияОДоходах.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТДоходы
		|ИЗ
		|	ВТСведенияОДоходах КАК СведенияОДоходах
		|
		|СГРУППИРОВАТЬ ПО
		|	СведенияОДоходах.ФизЛицо,
		|	СведенияОДоходах.ВидДохода,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	ДанныеДокумента.Скидка,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	ЕСТЬNULL(СведенияОДоходах.Результат, 0) КАК Результат,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходы КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|УПОРЯДОЧИТЬ ПО
		|	ФизЛицо,
		|	ВидДохода";
	ИначеЕсли ПериодРегистрации < ПроведениеРасчетов.ДатаСниженияТарифовСтраховыхВзносов() Тогда
		ТаблицаРаспределения.Колонки.Добавить("ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам");
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
		|	СтраховыеВзносыСведенияОДоходах.ВидДохода,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
		|	СтраховыеВзносыСведенияОДоходах.Результат,
		|	СтраховыеВзносыСведенияОДоходах.ВидРасчета
		|ПОМЕСТИТЬ ВТДанныеДоходовДокумента
		|ИЗ
		|	&ТаблицаДоходов КАК СтраховыеВзносыСведенияОДоходах
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетИсчисленный.ФизЛицо КАК ФизЛицо,
		|	РасчетИсчисленный.Скидка,
		|	РасчетИсчисленный.ВидДохода КАК ВидДохода
		|ПОМЕСТИТЬ ВТДанныеДокумента
		|ИЗ
		|	&НеоблагаемыеСуммы КАК РасчетИсчисленный
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.Результат КАК Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам КАК ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ВидРасчета КАК ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу КАК ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТСведенияОДоходах
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &ПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &ОбособленноеПодразделение
		|	И СведенияОДоходах.Регистратор <> &Регистратор
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо,
		|	ДанныеДокумента.ВидДохода,
		|	СведенияОДоходах.Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДанныеДоходовДокумента КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СУММА(СведенияОДоходах.Результат) КАК Результат,
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
		|	СведенияОДоходах.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТДоходы
		|ИЗ
		|	ВТСведенияОДоходах КАК СведенияОДоходах
		|
		|СГРУППИРОВАТЬ ПО
		|	СведенияОДоходах.ФизЛицо,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидДохода,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	ДанныеДокумента.Скидка,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	ЕСТЬNULL(СведенияОДоходах.Результат, 0) КАК Результат,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходы КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|УПОРЯДОЧИТЬ ПО
		|	ФизЛицо,
		|	ВидДохода";
	Иначе
		ТаблицаРаспределения.Колонки.Добавить("ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам");
		ТаблицаРаспределения.Колонки.Добавить("ЯвляетсяДоходомФармацевта");
		ТаблицаРаспределения.Колонки.Добавить("ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ");
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СтраховыеВзносыСведенияОДоходах.ФизЛицо,
		|	СтраховыеВзносыСведенияОДоходах.ВидДохода,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяЕНВД,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СтраховыеВзносыСведенияОДоходах.ОблагаетсяПоДополнительномуТарифу,
		|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СтраховыеВзносыСведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	СтраховыеВзносыСведенияОДоходах.Результат,
		|	СтраховыеВзносыСведенияОДоходах.ВидРасчета
		|ПОМЕСТИТЬ ВТДанныеДоходовДокумента
		|ИЗ
		|	&ТаблицаДоходов КАК СтраховыеВзносыСведенияОДоходах
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	РасчетИсчисленный.ФизЛицо КАК ФизЛицо,
		|	РасчетИсчисленный.Скидка,
		|	РасчетИсчисленный.ВидДохода КАК ВидДохода
		|ПОМЕСТИТЬ ВТДанныеДокумента
		|ИЗ
		|	&НеоблагаемыеСуммы КАК РасчетИсчисленный
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.Результат КАК Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД КАК ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам КАК ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	СведенияОДоходах.ВидРасчета КАК ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу КАК ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТСведенияОДоходах
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтраховыеВзносыСведенияОДоходах КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(СведенияОДоходах.Период, МЕСЯЦ) = &ПериодРегистрации
		|	И СведенияОДоходах.ОбособленноеПодразделение = &ОбособленноеПодразделение
		|	И СведенияОДоходах.Регистратор <> &Регистратор
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо,
		|	ДанныеДокумента.ВидДохода,
		|	СведенияОДоходах.Результат,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДанныеДоходовДокумента КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СУММА(СведенияОДоходах.Результат) КАК Результат,
		|	СведенияОДоходах.ФизЛицо КАК ФизЛицо,
		|	СведенияОДоходах.ВидДохода КАК ВидДохода,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ПОМЕСТИТЬ ВТДоходы
		|ИЗ
		|	ВТСведенияОДоходах КАК СведенияОДоходах
		|
		|СГРУППИРОВАТЬ ПО
		|	СведенияОДоходах.ФизЛицо,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ВидДохода,
		|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидДохода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.ФизЛицо КАК ФизЛицо,
		|	ДанныеДокумента.ВидДохода КАК ВидДохода,
		|	ДанныеДокумента.Скидка,
		|	СведенияОДоходах.ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам,
		|	СведенияОДоходах.ОблагаетсяЕНВД,
		|	СведенияОДоходах.ЯвляетсяДоходомФармацевта,
		|	СведенияОДоходах.ЯвляетсяДоходомЧленаЭкипажаСуднаПодФлагомРФ,
		|	ЕСТЬNULL(СведенияОДоходах.Результат, 0) КАК Результат,
		|	СведенияОДоходах.ВидРасчета,
		|	СведенияОДоходах.ОблагаетсяПоДополнительномуТарифу
		|ИЗ
		|	ВТДанныеДокумента КАК ДанныеДокумента
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходы КАК СведенияОДоходах
		|		ПО ДанныеДокумента.ФизЛицо = СведенияОДоходах.ФизЛицо
		|			И ДанныеДокумента.ВидДохода = СведенияОДоходах.ВидДохода
		|
		|УПОРЯДОЧИТЬ ПО
		|	ФизЛицо,
		|	ВидДохода";
	КонецЕсли;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.СледующийПоЗначениюПоля("ФизЛицо") Цикл
		
		Пока Выборка.СледующийПоЗначениюПоля("ВидДохода") Цикл
			
			СкидкаКРаспределению = Выборка.Скидка;
			
			ТаблицаРаспределения.Очистить();
			Пока Выборка.Следующий() Цикл
				ЗаполнитьЗначенияСвойств(ТаблицаРаспределения.Добавить(),Выборка);
			КонецЦикла;
			
			МассивКоэффициентов = ТаблицаРаспределения.ВыгрузитьКолонку("Результат");
			МассивСуммКНачислению = ОбщегоНазначенияЗК.РаспределитьПропорционально(СкидкаКРаспределению,МассивКоэффициентов);
			
			Если МассивСуммКНачислению = Неопределено Тогда
				
				СтрокаДвижения = НаборЗаписейОДоходах.Добавить();
				ЗаполнитьЗначенияСвойств(СтрокаДвижения,ВыборкаПоШапкеДокумента);  // Период, Организация, ОбособленноеПодразделение
				ЗаполнитьЗначенияСвойств(СтрокаДвижения,Выборка,,"Результат"); // ФизЛицо,ВидДохода,ОблагаетсяЕНВД,ВидРасчета, ОблагаетсяПоДополнительномуТарифу, ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам
				// ресурсы
				СтрокаДвижения.Скидка = СкидкаКРаспределению;
				
			Иначе
				
				Для каждого СтрокаТЗ Из ТаблицаРаспределения Цикл
					
					СтрокаДвижения = НаборЗаписейОДоходах.Добавить();
					ЗаполнитьЗначенияСвойств(СтрокаДвижения,ВыборкаПоШапкеДокумента);  // Период, Организация, ОбособленноеПодразделение
					ЗаполнитьЗначенияСвойств(СтрокаДвижения,СтрокаТЗ,,"Результат"); // ФизЛицо,ВидДохода,ОблагаетсяЕНВД,ВидРасчета,ОблагаетсяПоДополнительномуТарифу, ОблагаетсяВзносамиНаДоплатуКПенсииШахтерам
					// ресурсы
					СтрокаДвижения.Скидка = МассивСуммКНачислению[ТаблицаРаспределения.Индекс(СтрокаТЗ)];
					
				КонецЦикла;
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ОбработкаПроведения(Отказ, Режим)
	
	ОбработкаКомментариев = глЗначениеПеременной("глОбработкаСообщений");
	ОбработкаКомментариев.УдалитьСообщения();
	
	// Заголовок для сообщений об ошибках проведения.
	Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);
	
	ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
	ВыборкаПоШапкеДокумента.Следующий();
	ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок);
	
	Движения.СтраховыеВзносыИсчисленные.мВыполнятьДополнительныеДвижения = Истина;
	
	Для каждого СтрокаТЧ Из ИсчисленныеСтраховыеВзносы Цикл
		ПроверитьЗаполнениеСтрокиВзносов(СтрокаТЧ, Отказ);
		Если Не Отказ Тогда
			ДобавитьСтрокуВДвиженияПоВзносам(СтрокаТЧ, ВыборкаПоШапкеДокумента);
		КонецЕсли;
	КонецЦикла;
	
	Для каждого СтрокаТЧ Из НеоблагаемыеСуммыДоходов Цикл
		ПроверитьЗаполнениеСтрокиСкидок(СтрокаТЧ, Отказ, Заголовок);
	КонецЦикла; 
	
	Если Не Отказ Тогда
		РасчетСтраховыхВзносовПереопределяемый.ДополнительныеДействияОбработкиПроведения(ЭтотОбъект, ВыборкаПоШапкеДокумента, Заголовок, Отказ);
		СформироватьДвиженияПоСкидкам(ВыборкаПоШапкеДокумента);	
	КонецЕсли;
	
	Если Отказ Тогда
		ОбработкаКомментариев.ПоказатьСообщения();
	КонецЕсли;
	
КонецПроцедуры // ОбработкаПроведения()

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	МассивТЧ = Новый Массив();
	МассивТЧ.Добавить(ИсчисленныеСтраховыеВзносы);
	
	КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(МассивТЧ, "Физлицо");
	
КонецПроцедуры // ПередЗаписью()