Процедура КоманднаяПанельСформировать(Кнопка)	
	СерияНоменклатуры = ЭлементыФормы.Серия.Значение;
	СформироватьОтчет(ЭлементыФормы.ОсновнойДокумент);
КонецПроцедуры

Процедура НоменклатураПриИзменении(Элемент)
	Серия = "";
	СерияНоменклатуры = "";
КонецПроцедуры

Процедура СерияПриИзменении(Элемент)
	
	СерияНоменклатуры = Серия;
	Если НЕ ЗначениеЗаполнено(Номенклатура) И ЗначениеЗаполнено(СерияНоменклатуры) Тогда
		Номенклатура = СерияНоменклатуры.Владелец;
	КонецЕсли;
	
КонецПроцедуры

// Открывает новое окно отчета, копируя содержимое текущего.
Процедура ДействияФормыНовоеОкно(Кнопка)
	ТекущийОтчет = ЭтотОбъект;

	НовыйОтчет = Отчеты.АнализСерии.Создать();

	Для каждого Реквизит Из Метаданные.Отчеты["АнализСерии"].Реквизиты Цикл

		НовыйОтчет[Реквизит.Имя] = ТекущийОтчет[Реквизит.Имя];

	КонецЦикла;
	
	НовыйОтчетФорма = НовыйОтчет.ПолучитьФорму();
	НовыйОтчетФорма.ЭлементыФормы.ОсновнойДокумент.Очистить();
	НовыйОтчетФорма.ЭлементыФормы.ОсновнойДокумент.Вывести(ЭлементыФормы.ОсновнойДокумент.ПолучитьОбласть());
	НовыйОтчетФорма.Открыть();
КонецПроцедуры