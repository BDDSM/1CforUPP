Процедура ПриОткрытии()
	
	ЗаполнитьСписокУЦ()
	
КонецПроцедуры

Процедура ЗаполнитьСписокУЦ()
	
	Для Каждого СпецоператорСвязи Из Перечисления.СпецоператорыСвязи Цикл
		Значение = КонтекстЭДО.ПолучитьПараметрСпецоператора(Спецоператорсвязи,"ВебСервисПризнак");
		Если Значение = Неопределено Тогда
		ИначеЕсли Значение Тогда
			ЭлементыФормы.СпецоператорИУЦ.СписокВыбора.Добавить(Спецоператорсвязи);
		КонецЕсли;
	КонецЦикла;
	
	Если ЭлементыФормы.СпецоператорИУЦ.СписокВыбора.Количество() = 1 Тогда
		Спецоператор = ЭлементыФормы.СпецоператорИУЦ.СписокВыбора.Получить(0).Значение;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОК(Кнопка)
	
	ИдентификаторАбонента = СокрЛП(ИдентификаторАбонента);
	
	Если Спецоператор = Неопределено ИЛИ Спецоператор = Перечисления.СпецоператорыСвязи.ПустаяСсылка() Тогда
		Сообщить("Укажите специализированного оператора связи (удостоверяющий центр).");
	ИначеЕсли ПустаяСтрока(ИдентификаторАбонента) Тогда
		Сообщить("Укажите идентификатор абонента.");
	ИначеЕсли СтрДлина(ИдентификаторАбонента) < 4 Тогда
		Сообщить("Слишком короткий идентификатор абонента.");
	Иначе
		КодАбонента = Сред(ИдентификаторАбонента,4);
		Результат = КонтекстЭДО.ОбработатьОбновление(КодАбонента, Спецоператор, Неопределено, Неопределено, Организация, Ложь, Ложь);
		Если Результат Тогда 
			 Закрыть();
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры