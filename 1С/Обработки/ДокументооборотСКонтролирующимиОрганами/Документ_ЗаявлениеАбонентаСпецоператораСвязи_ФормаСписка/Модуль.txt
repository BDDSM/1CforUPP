Процедура ДействияФормыСеансСвязи(Кнопка)
	
	КонтекстЭДО.ОбменССерверомРегистрацииЭДО();
	
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если Не РежимВыбора Тогда
		ЭлементыФормы.ДействияФормы.Кнопки.Удалить(0);
	КонецЕсли;
	
КонецПроцедуры

Процедура ДействияФормыРучноеЗаполнение(Кнопка)
	
	ФормаНовогоЗаявления = Документы.ЗаявлениеАбонентаСпецоператораСвязи.ПолучитьФорму("ФормаДокумента");
	ФормаНовогоЗаявления.ДополнительныеСвойства.Вставить("РучноеЗаполнение", Истина);
	ФормаНовогоЗаявления.Открыть();
	
КонецПроцедуры

Процедура ТабличноеПолеЗаписейЭДОПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	Если ДанныеСтроки.Статус = Перечисления.СтатусыЗаявленияАбонентаСпецоператораСвязи.Отклонено Тогда
		ОформлениеСтроки.Ячейки.Статус.ЦветТекста = WebЦвета.Красный;
	ИначеЕсли ДанныеСтроки.Статус = Перечисления.СтатусыЗаявленияАбонентаСпецоператораСвязи.Одобрено Тогда
		ОформлениеСтроки.Ячейки.Статус.ЦветТекста = WebЦвета.Зеленый;
	Иначе
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ДействияФормыИзменитьСтатус(Кнопка)
	
	Данные = ЭлементыФормы.ТабличноеПолеЗаписейЭДО.ТекущаяСтрока;
	
	Если Данные = Неопределено Тогда
		
		Предупреждение("Выберите заявление для изменения статуса !");
		
	ИначеЕсли Данные.Статус <> Перечисления.СтатусыЗаявленияАбонентаСпецоператораСвязи.Подготовлено 
		И Данные.Статус <> Перечисления.СтатусыЗаявленияАбонентаСпецоператораСвязи.Отправлено Тогда
		
		Предупреждение("Ручное изменение статуса возможно только для заявлений со статусом <Подготовлено> или <Отправлено> !")
		
	Иначе
		
		Ответ = Вопрос("Отменить заявление " + Данные.Номер + " от " + Данные.Дата  + " ? 
		|
		|Отмена необратима, получение ответа на заявление и создание учетной записи станет невозможным.", РежимДиалогаВопрос.ДаНет);
		Если Ответ = КодВозвратаДиалога.Да Тогда
			Документ = Данные.ПолучитьОбъект();
			Документ.Статус = Перечисления.СтатусыЗаявленияАбонентаСпецоператораСвязи.Отклонено;
			Документ.СтатусКомментарий = "Отменено пользователем.";
			Документ.Записать();
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры