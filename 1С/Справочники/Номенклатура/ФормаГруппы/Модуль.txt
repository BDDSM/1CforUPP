Процедура ДействияФормыРедактироватьКод(Кнопка)
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(ЭтотОбъект.Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
КонецПроцедуры

// Процедура - обработчик события "ПриОткрытии" формы.
//
Процедура ПриОткрытии()

	Если ЭтоНовый() И НЕ ЗначениеЗаполнено(ВидНоменклатуры) Тогда
		
		Если ЗначениеЗаполнено(Родитель.ВидНоменклатуры) Тогда
			//Унаследуем вид номенклатуры у родителя
			ВидНоменклатуры = Родитель.ВидНоменклатуры;
		Иначе
			//Возьмем из настроек пользователя
			ВидНоменклатуры = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнойВидНоменклатуры");
		КонецЕсли;
		
	КонецЕсли;

	ИспользоватьСерийныеНомера = Константы.ИспользоватьСерийныеНомера.Получить();
	Если Не ИспользоватьСерийныеНомера Тогда
		ЭлементыФормы.ПорядокПрисвоенияСерийногоНомера.Видимость        = Ложь;
		ЭлементыФормы.НадписьПорядокПрисвоенияСерийногоНомера.Видимость = Ложь;
	КонецЕсли;

	МеханизмНумерацииОбъектов.ДобавитьВМенюДействияКнопкуРедактированияКода(ЭлементыФормы.ДействияФормы.Кнопки.Подменю);
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю,ЭлементыФормы.Код);
	
КонецПроцедуры // ПриОткрытии()

Процедура КоманднаяПанельФормыПрава(Кнопка)
	
	Если НЕ РаботаСДиалогами.ЗаписатьНовыйОбъектВФорме(ЭтаФорма) Тогда
		Возврат;
	КонецЕсли;
	
	НастройкаПравДоступа.РедактироватьПраваДоступа(Ссылка);
	
КонецПроцедуры

// Обработчик события "ПослеЗаписи" формы.
//
Процедура ПослеЗаписи()

	МеханизмНумерацииОбъектов.ОбновитьПодсказкуКодНомерОбъекта(ЭтотОбъект.Метаданные(), ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);

КонецПроцедуры // ПослеЗаписи()


Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	// При необходимости удалим кнопку Права
	РаботаСДиалогами.УдалитьКнопкуПрава(ЭлементыФормы.ДействияФормы.Кнопки);
	
КонецПроцедуры