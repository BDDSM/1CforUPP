Процедура ЗаполнитьСтатьиОтчета()

	СправСтатьиОтчета= Справочники.СтатьиОтчетаОПрибыляхИУбытках;
	
	МакетСтатьи=СправСтатьиОтчета.ПолучитьМакет("ПрибылиИУбытки");
	ОбластьСтатьи = МакетСтатьи.ПолучитьОбласть("Список");
	ОбластьСтатьиВысота = ОбластьСтатьи.ВысотаТаблицы;
	
	НачатьТранзакцию();
	
	Для НСтр = 1 По ОбластьСтатьиВысота Цикл
		
		НовыйОбъект=СправСтатьиОтчета.СоздатьЭлемент();
        НовыйОбъект.Владелец=ПараметрОтборПоВладельцу;
		НовыйОбъект.Код = СокрЛП(ОбластьСтатьи.Область(НСтр, 2).Текст);
		НовыйОбъект.Наименование=СокрЛП(ОбластьСтатьи.Область(НСтр, 1).Текст);
		НовыйОбъект.ОбластьОтчета=СокрЛП(ОбластьСтатьи.Область(НСтр, 3).Текст);
		НовыйОбъект.НаименованиеДляОтчета=СокрЛП(ОбластьСтатьи.Область(НСтр, 4).Текст);
		НовыйОбъект.Записать();
		
	КонецЦикла;
	
	ЗафиксироватьТранзакцию();
	
	
КонецПроцедуры // ЗаполнитьСтатьиОтчета()


Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если  ПараметрОтборПоВладельцу=Неопределено Тогда
		
		Сообщить("Справочник относится к подсистеме ""Бюджетирование"" и не предназначен для открытия из меню ""Операции"".",СтатусСообщения.Внимание);
		Отказ=Истина;
		
		Возврат;
		
	КонецЕсли;	
	
	Запрос=Новый Запрос;
	Запрос.Текст="ВЫБРАТЬ
	|	СтатьиОтчетаОПрибыляхИУбытках.Ссылка
	|ИЗ
	|	Справочник.СтатьиОтчетаОПрибыляхИУбытках КАК СтатьиОтчетаОПрибыляхИУбытках
	|
	|ГДЕ
	|	СтатьиОтчетаОПрибыляхИУбытках.Владелец = &Владелец";
	
	Запрос.УстановитьПараметр("Владелец",ПараметрОтборПоВладельцу); 
	
	Если Запрос.Выполнить().Пустой() Тогда
		ЗаполнитьСтатьиОтчета();
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если Не ПараметрОтборПоВладельцу=Неопределено Тогда
		
		Заголовок=ПараметрОтборПоВладельцу.Наименование+": статьи отчета о прибылях и убытках.";
		Порядок.Установить("Код");
		
	КонецЕсли;
	
КонецПроцедуры