// Хранит дерево макетов печатных форм
Перем мДеревоМакетов;

// Хранит элемент управления подменю печати
Перем мПодменюПечати;


// Возвращает доступные варианты печати документа
//
// Возвращаемое значение:
//  Структура, каждая строка которой соответствует одному из вариантов печати
//  
Функция ПолучитьСтруктуруПечатныхФорм() Экспорт
	
	Возврат Новый Структура("ОС6_2003упр,ОС6_2003бух","Форма ОС-6 (упр. учет)","Форма ОС-6 (бух. учет)");

КонецФункции // ПолучитьТаблицуПечатныхФорм()

Процедура УстановитьКнопкиПечати()
	
	ПустаяСсылка = Справочники.ОсновныеСредства.ПустаяСсылка();
	мДеревоМакетов = УниверсальныеМеханизмы.ПолучитьДеревоМакетовПечати(ПустаяСсылка, ПолучитьСтруктуруПечатныхФорм(), Новый Действие("ОсновныеДействияФормыПечать"), Новый Действие("ОсновныеДействияФормыУстановитьПечатьПоУмолчанию"));

	мПодменюПечати = ЭлементыФормы.ДействияФормы.Кнопки.ПодменюПечати;

	УниверсальныеМеханизмы.СформироватьПодменю(мДеревоМакетов, мПодменюПечати, Истина, Истина);
	
КонецПроцедуры // ()

Процедура ДействияФормыРедактироватьКод(Кнопка)
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(Метаданные.Справочники.ОсновныеСредства, ЭлементыФормы.СправочникСписок, ЭлементыФормы.ДействияФормы.Кнопки.Подменю1, ЭлементыФормы.СправочникСписок.Колонки.Код);
КонецПроцедуры
Процедура ДействияФормыДействие1(Кнопка)

	ОС = ЭлементыФормы.СправочникСписок.ТекущаяСтрока;
	Если НЕ ЗначениеЗаполнено(ОС) Тогда
		ОС = Справочники.ОсновныеСредства.ПустаяСсылка();
	КонецЕсли;
	
	ФормаРегистра = РегистрыНакопления.ОплатыОСДляУСН.ПолучитьФормуСписка();
	ФормаРегистра.Отбор.ОсновноеСредство.Использование = Истина;
	ФормаРегистра.Отбор.ОсновноеСредство.Значение = ОС;
	ФормаРегистра.Открыть();
	
КонецПроцедуры


// Обработчик события элемента КоманднаяПанельФормы.ДействиеКатегории.
//
Процедура ДействияФормыДействиеКатегории(Кнопка)

	Если ЭлементыФормы.СправочникСписок.ТекущаяСтрока = неопределено Тогда
		Возврат;
	КонецЕсли;
	Форма = Обработки.КатегорииОбъекта.ПолучитьФорму("КатегорииОбъекта", ЭтаФорма, );
	Форма.ОбъектОтбораКатегорий = ЭлементыФормы.СправочникСписок.ТекущаяСтрока;
	Форма.ПрочитатьЗаполнитьКатегорииОбъекта();
	Форма.Открыть();

КонецПроцедуры


// Обработчик события элемента КоманднаяПанельФормы.ДействиеСвойства.
//
Процедура ДействияФормыДействиеСвойства(Кнопка)

	Если ЭлементыФормы.СправочникСписок.ТекущаяСтрока = неопределено Тогда
		Возврат;
	КонецЕсли;
	Форма = Обработки.ЗначенияСвойствОбъекта.ПолучитьФорму("ЗначенияСвойствОбъекта", ЭтаФорма, );
	Форма.ОбъектОтбораЗначений   = ЭлементыФормы.СправочникСписок.ТекущаяСтрока;
	Форма.ОбъектОтбораНазначений = ЭлементыФормы.СправочникСписок.ТекущаяСтрока;
	Форма.ПрочитатьЗаполнитьСвойстваИЗначения();
	Форма.Открыть();

КонецПроцедуры

// Процедура вызывается при нажатии кнопки "Групповое добавление" командной 
// панели формы, вызывает форму группового добавления элементов справочника.
//
Процедура ДействияФормыГрупповоеДобавление(Кнопка)
		
	ФормаГрупповогоВвода = Справочники.ОсновныеСредства.ПолучитьФорму("ФормаГрупповогоДобавления", ЭтаФорма);
	ФормаГрупповогоВвода.Открыть();
	
КонецПроцедуры // ДействияФормыГрупповоеДобавление()

Процедура ПриОткрытии()
	
	УстановитьКнопкиПечати();
	
	
	МеханизмНумерацииОбъектов.ДобавитьВМенюДействияКнопкуРедактированияКода(ЭлементыФормы.ДействияФормы.Кнопки.Подменю1);
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные.Справочники.ОсновныеСредства, ЭлементыФормы.СправочникСписок, ЭлементыФормы.ДействияФормы.Кнопки.Подменю1, ЭлементыФормы.СправочникСписок.Колонки.Код);
КонецПроцедуры //ПриОткрытии()

// Процедура - обработчик нажатия на кнопку "Печать"
//
Процедура ОсновныеДействияФормыПечать(Кнопка)
	
	Ссылка = ЭлементыФормы.СправочникСписок.ТекущаяСтрока;
	Если Не Ссылка = Неопределено Тогда
		Объект = Ссылка.ПолучитьОбъект();
		УниверсальныеМеханизмы.ПечатьПоДополнительнойКнопкеВСписке(мДеревоМакетов, Объект, , Кнопка.Текст);
		
	КонецЕсли;
	 
	
	
КонецПроцедуры

// Процедура - обработчик нажатия на кнопку "Установить печать по умолчанию"
//
Процедура ОсновныеДействияФормыУстановитьПечатьПоУмолчанию(Кнопка)
	
	Если УниверсальныеМеханизмы.НазначитьКнопкуПечатиПоУмолчанию(мДеревоМакетов, "ОсновныеСредства") Тогда
		
		УстановитьКнопкиПечати();
		
	КонецЕсли; 
	
	
КонецПроцедуры

// Процедура - обработчик события "ПриИзменении" поля ввода "Код по ОКОФ".
//
Процедура СправочникСписокКодПоОКОФПриИзменении(Элемент)
	
	Если НЕ Элемент.Значение.Пустая() Тогда
		ЭлементыФормы.СправочникСписок.ТекущиеДанные.АмортизационнаяГруппа = Элемент.Значение.АмортизационнаяГруппа;
	КонецЕсли;
	
КонецПроцедуры // СправочникСписокКодПоОКОФПриИзменении()