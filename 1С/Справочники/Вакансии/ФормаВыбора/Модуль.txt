////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// устанавливает отбор по актуальности вакансий
Процедура УстановитьОтборПоАктуальности()
	
	Элемент = ЭлементыФормы.ОтборПоАктуальности.Значение;
	СправочникСписок.Отбор.Закрыта.Значение = ЗначениеЗаполнено(Элемент) и Элемент;
	СправочникСписок.Отбор.Закрыта.Использование = ЗначениеЗаполнено(Элемент);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

Процедура ПриОткрытии()
	
	ВакансииПереопределяемый.ПриОткрытииФормыСпискаДополнительно(ЭтаФорма);

	СохраненноеЗначениеОтборПоАктуальности = ЭлементыФормы.ОтборПоАктуальности.СписокВыбора.НайтиПоЗначению(ВосстановитьЗначение("Справочник.Вакансии.ОтборЗакрыта"));
	Если СохраненноеЗначениеОтборПоАктуальности = НеОпределено Тогда
		ЭлементыФормы.ОтборПоАктуальности.Значение = ЭлементыФормы.ОтборПоАктуальности.СписокВыбора.Получить(0).Значение;
	Иначе
		ЭлементыФормы.ОтборПоАктуальности.Значение = СохраненноеЗначениеОтборПоАктуальности.Значение;
	КонецЕсли;
	
	УстановитьОтборПоАктуальности();
	
	ОтборОрганизация = ВосстановитьЗначение("Справочник.Вакансии.ОтборОрганизация");
	Если ОтборОрганизация = Неопределено Тогда
		ОтборОрганизация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяОрганизация");
	КонецЕсли;
	ОтборОрганизацияИспользование = ВосстановитьЗначение("Справочник.Вакансии.ОтборОрганизацияИспользование");
	Если ОтборОрганизацияИспользование = Неопределено Тогда
		ОтборОрганизацияИспользование = НЕ ОтборОрганизация.Пустая();
	КонецЕсли;
	
	Отбор.Организация.Значение		= ОтборОрганизация;
	Отбор.Организация.Использование	= ОтборОрганизацияИспользование;
	
	ТекущийЭлемент = ЭлементыФормы.СправочникСписок;
	
	УстановитьЗаголовкиОрганизацийВФорме();
	
КонецПроцедуры

Процедура ПриЗакрытии()
	
	СохранитьЗначение("Справочник.Вакансии.ОтборЗакрыта",					ЭлементыФормы.ОтборПоАктуальности.Значение);
	СохранитьЗначение("Справочник.Вакансии.ОтборОрганизация",				Отбор.Организация.Значение);
	СохранитьЗначение("Справочник.Вакансии.ОтборОрганизацияИспользование",	Отбор.Организация.Использование);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

//Процедура - обработчик события "ПриИзменении" ЭУ ОтборПоАктуальности
Процедура ОтборПоАктуальностиПриИзменении(Элемент)
	
	УстановитьОтборПоАктуальности();
	
КонецПроцедуры

Процедура ОрганизацияПриИзменении(Элемент)
		
	Если Элемент.Значение = Неопределено Тогда
		Элемент.Значение = Справочники.Организации.ПустаяСсылка();
	КонецЕсли;
	
	Отбор.Организация.Использование = Не Элемент.Значение.Пустая();
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ТАБЛИЧНОГО ПОЛЯ СправочникСписок

Процедура СправочникСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	РаботаСДиалогамиЗК.ВакансияПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки);
	
КонецПроцедуры

Процедура УстановитьЗаголовкиОрганизацийВФорме()
	
	ЭлементыФормы.ОрганизацияФлаг.Заголовок = ОбщегоНазначения.ПреобразоватьСтрокуИнтерфейса("Организация:");
	ЭлементыФормы.СправочникСписок.Колонки.Организация.ТекстШапки = ОбщегоНазначения.ПреобразоватьСтрокуИнтерфейса("Организация");
КонецПроцедуры // УстановитьЗаголовкиОрганизацийВФорме()

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

СправочникСписок.Колонки.Добавить("Закрыта");
СправочникСписок.Колонки.Добавить("ПлановаяДатаЗакрытия");

//список отборов по актуальности сотрудников
СписокОтборов = Новый СписокЗначений;
СписокОтборов.Добавить(Ложь,	"Открытые вакансии");
СписокОтборов.Добавить(0,		"Все вакансии");
СписокОтборов.Добавить(Истина,	"Закрытые вакансии");
ЭлементыФормы.ОтборПоАктуальности.СписокВыбора = СписокОтборов;